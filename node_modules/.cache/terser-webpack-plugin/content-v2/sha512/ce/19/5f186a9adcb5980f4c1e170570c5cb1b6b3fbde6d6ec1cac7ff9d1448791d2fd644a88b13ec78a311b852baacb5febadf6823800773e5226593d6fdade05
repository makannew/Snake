{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){n(1)},function(e,t,n){\"use strict\";n.r(t);class i{constructor(e){if(e){this.arr=[];for(let t=0,n=e.length;t<n;++t)this.arr.push(e[t])}else this.arr=[]}extend(e){if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)this.arr.push(e[t]);else this.arr.push(e)}clear(){this.arr=[]}isEqual(e){let t=this.arr.length;if(t!=e.arr.length)return!1;for(let n=t-1;n>-1;--n)if(this.arr[n]!=e.arr[n])return!1;return!0}getRefFrom(e){let t=e;for(let e=0,n=this.arr.length;e<n;++e)t=\"object\"==typeof t&&null!=t?Reflect.get(t,this.arr[e]):void 0;return t}existIn(e){for(let t=0,n=e.length;t<n;++t)if(this.isEqual(e[t]))return!0;return!1}indexIn(e){for(let t=0,n=e.length;t<n;++t)if(this.isEqual(e[t]))return t;return-1}buildPath(e){let t=e;for(let e=0,n=this.arr.length;e<n;++e)t.hasOwnProperty(this.arr[e])||Reflect.set(t,this.arr[e],{}),t=Reflect.get(t,this.arr[e]);return t}name(){return this.arr[this.arr.length-1]}isIn(e){let t=e;for(let e=0,n=this.arr.length;e<n;++e){if(\"object\"!=typeof t||null==t||!t.hasOwnProperty(this.arr[e]))return!1;t=Reflect.get(t,this.arr[e])}return!0}getObject(e){let t=e;for(let e=0,n=this.arr.length-1;e<n;++e)t=Reflect.get(t,this.arr[e]);return t}isParent(e){if(this.arr.length>e.arr.length)return!1;for(let t=0,n=this.arr.length;t<n;++t)if(this.arr[t]!=e.arr[t])return!1;return!0}}var a=function(){const e=Symbol.for(\"metaDataKey\"),t={},n=Object.getPrototypeOf((async function(){})).constructor,a=/.*?\\(\\{([^)]*)\\}\\)/;let o=!1,s=!1,r=!1,l={};const c=async function(n){let a=[],o=n.getObject(t),s=new i(n.arr);s.arr.pop(),o[n.name()]=await n.getRefFrom(d)[e].function(o,t,function(e,t,n){let a=new i,o=new i(t.arr);o.arr.pop();return new Proxy(e,{set(e,t,o,s){a.extend(t),a.existIn(n)||n.push(new i(a.arr)),Reflect.set(e,t,o,s)},get:function(t,n,s){if(t==e&&(a=new i(o.arr)),n!=Symbol.unscopables)return a.extend(n),Reflect.get(t,n,s)},has:(t,n)=>!!e.hasOwnProperty(n)})}(o,n,a),t[e].compositeProxy,s.arr),a.push(new i(n.arr)),r=!0,x(a)};t[e]={updateQueue:[],metaTree:{}};let d=t[e].metaTree,u=t[e].updateQueue;d[e]={type:\"root\",affectedFunctions:[],inputProps:[],externalLinks:[]};const p=function(e,n){let a,o=n.getRefFrom(t),s=[];Object.assign(o,e);for(let t in e)a=new i(n.arr),a.extend(t),s.push(new i(a.arr)),a.isIn(d)||b(a);r=!0,x(s)},m=function(){s=!1;let t=[];if(!arguments[0])throw console.error(\"at least an address need for remove link\");for(let e of l.property)if(e.existIn(t)||t.push(new i(e.arr)),!e.isIn(d))throw console.error(\"removeLink address not found\");for(let n=0;n<t.length;++n){let i=t[n].getRefFrom(d)[e].externalLinks;for(let a=0;a<i.length;++a){let o=i[a].getRefFrom(d)[e].externalLinks,s=t[n].indexIn(o);s>-1&&o.splice(s,1)}t[n].getRefFrom(d)[e].externalLinks=[]}},h=function(){o=!1;let n=[];if(!arguments[1])throw console.error(\"at least two address need for linking\");for(let e of l.property)e.existIn(n)||n.push(new i(e.arr)),e.isIn(d)||(e.buildPath(t),b(e));let a=[...n];for(let t=0;t<n.length;++t){let o=n[t].getRefFrom(d)[e].externalLinks;for(let e=0;e<o.length;++e)o[e].existIn(a)||a.push(new i(o[e].arr))}for(let t=0;t<a.length;++t){let n=a.filter(e=>!a[t].isEqual(e));a[t].getRefFrom(d)[e].externalLinks=[...n]}r=!0,x([...w(n[0])])},g=function(a,o){let s,r,l=[],u=y(a),p=y((function(){})).body+\"with (arguments[2]) {\"+u.body+\"}\";if(!u.paraString)throw console.error(\"Function must have at least one input parameter\");u.paraArray.forEach(e=>{let t=new i(o.arr);t.extend(e),l.push(new i(t.arr))}),r=\"{\"+u.paraString+\"}\",s=new n(r,p),Object.defineProperty(s,\"name\",{value:a.name,configurable:!0});let m=new i(o.arr);m.extend(a.name),m.isIn(d)||b(m);let h=m.getRefFrom(d)[e];h.function=s,h.type=\"func\",m.isIn(t)||(m.buildPath(t),m.getObject(t)[a.name]=void 0);for(let n=0,a=l.length;n<a;++n)h.inputProps.push(new i(l[n].arr)),l[n].isIn(d)||b(l[n]),l[n].getRefFrom(d)[e].affectedFunctions.push(new i(m.arr)),l[n].isIn(t)||(l[n].buildPath(t),l[n].getObject(t)[l[n].name()]=void 0);N(m)&&c(m)},b=function(t){let n=d;for(let i=0,a=t.arr.length;i<a;++i)n.hasOwnProperty(t.arr[i])||(Reflect.set(n,t.arr[i],{}),n[t.arr[i]][e]={type:\"prop\",affectedFunctions:[],inputProps:[],externalLinks:[]}),n=Reflect.get(n,t.arr[i])},y=function(e){let t={},n=e.toString(),i=n.match(a);i&&(t.paraString=i[1],t.paraArray=t.paraString.split(\",\").map(e=>e.trim()));let o=n.slice(n.indexOf(\")\")+1,n.lastIndexOf(\"}\"));return t.body=o.slice(o.indexOf(\"{\")+1),t},w=function(n){let a=n.getRefFrom(d);if(!a)return[];let o=a[e].externalLinks,s=[];if(0==o.length)return o;let r=n.getObject(t);for(let e=0,a=o.length;e<a;++e){let a=o[e].getObject(t);a[o[e].name()]!==r[n.name()]&&(a[o[e].name()]=r[n.name()],s.push(new i(o[e].arr)))}return s},f=function(e){if(\"object\"!=typeof e)throw console.error(\"configuration properties: 'upPropagation' = boolian \");e.upPropagation&&e.upPropagation},x=function(t){let n=[new i],a=[];do{for(let e=0,a=t.length;e<a;++e){let a=new i(t[e].arr);for(;a.arr.length>1;)a.arr.pop(),a.existIn(n)||a.existIn(t)||n.push(new i(a.arr))}for(let e=0,a=n.length;e<a;++e)t.push(new i(n[e].arr));a=[];for(let e=0,n=t.length;e<n;++e)a.push(...w(t[e]));a.length>0&&t.push(...a)}while(a.length>0);for(let n=0,a=t.length;n<a;++n){let a=t[n].getRefFrom(d);if(a){let t=a[e].affectedFunctions;for(let e=0,n=t.length;e<n;++e)t[e].existIn(u)||N(t[e])&&u.push(new i(t[e].arr))}}for(;u.length>0;)c(u.shift());r=!1},N=function(n){let i=n.getRefFrom(d)[e].inputProps;for(let e=0,n=i.length;e<n;++e)if(void 0===i[e].getRefFrom(t))return!1;return!0},E=function(e,t,n,a){e==this.sourceObj&&(this.addressRecorder=new i(this.sourceAddress.arr));let o=this.addressRecorder;if(o.extend(t),Reflect.set(e,t,n,a),o.isIn(d)){let e=o.getRefFrom(d),t=Object.keys(e);for(let n of t)delete e[n]}else b(o);return r=!0,x([new i(o.arr)]),!0},T=function(n,a,c){n==this.sourceObj&&(this.addressRecorder=new i(this.sourceAddress.arr));let u=this.addressRecorder;if(o||s)return n[e]&&\"courier\"==n[e].name||l.property.push(new i(u.arr)),l.property[l.property.length-1].extend(a),new Proxy(l,{get:T,set:E,sourceObj:l,sourceAddress:new i(u.arr)});switch(a){case\"set\":return function(){p(arguments[0],new i(u.arr))};case\"addFunction\":return function(){g(arguments[0],new i(u.arr))};case\"addLink\":return o=!0,l={property:[]},l[e]={name:\"courier\"},h;case\"removeLink\":return s=!0,l={property:[]},l[e]={name:\"courier\"},m;case\"compositeRunningFunctions\":return r;case\"getParentComposite\":return t;case\"isCompositeProxy\":return!0;case\"getCurrentAddress\":return new i(u.arr);case\"getProxyLessObject\":return u.getRefFrom(t);case\"updateItself\":return r=!0,x([new i(u.arr)]),!0;case\"composerConfig\":return f}u.extend(a),u.isIn(d)||b(u);let y=Reflect.get(n,a,c);return\"object\"==typeof y&&null!=y?new Proxy(y,{get:T,set:E,sourceObj:y,sourceAddress:new i(u.arr)}):y},C=new Proxy(t,{get:T,set:E,sourceObj:t,sourceAddress:new i});return t[e].compositeProxy=C,C};function o({camera:e}){return o||mainComposite.loadedObjects.push(e),!0}function s({cameraFocalLenght:e,cameraNearView:t,cameraFarView:n}){return new THREE.PerspectiveCamera(e,window.innerWidth/window.innerHeight,t,n)}function r({camera:e,position:t}){return e.position.x=t.x,e.position.y=t.y,e.position.z=t.z,!0}function l({camera:e,quaternion:t}){return e.quaternion.x=t.x,e.quaternion.y=t.y,e.quaternion.z=t.z,e.quaternion.w=t.w,!0}function c({camera:e,three:t}){return function(){t.renderer.setSize(window.innerWidth,window.innerHeight),e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix()}}function d({active:e,cameraUpdateFunction:t}){return e?(d||window.addEventListener(\"resize\",t),!0):(d&&window.removeEventListener(\"resize\",t),!1)}function u({activate:e,camera:t}){e&&t&&(mainComposite.activeCamera=t)}function p(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.three=e.three.getProxyLessObject,t.self=t,t.mainComposite=e,t.addFunction(h),t.addFunction(m),t.addFunction(F),t.addFunction(y),t.addFunction(v),t.addFunction(T),t.addFunction(E),t.addFunction(j),t.addFunction(R),t.addFunction(C),t.addFunction(x),t.addFunction(w),t.addFunction(f),t.addFunction(b),t.addFunction(N),t.addFunction(g),null==t.geometryName&&(t.geometryName=\"plane\"),null==t.materialName&&(t.materialName=\"lambert\"),null==t.color&&(t.color=16777215),null==t.scale&&(t.scale=1),null==t.positio&&(t.position=new THREE.Vector3(0,0,0)),null==t.quaternio&&(t.quaternion=new THREE.Quaternion),null==t.visible&&(t.visible=!0),null==t.active&&(t.active=!0),null==t.widthSegments&&(t.widthSegments=32),null==t.heightSegments&&(t.heightSegments=32),null==t.radialSegments&&(t.radialSegments=32),null==t.cylinderHeightSegments&&(t.cylinderHeightSegments=1),null==t.shininess&&(t.shininess=30),null==t.castShadow&&(t.castShadow=!0),null==t.receiveShadow&&(t.receiveShadow=!0),null==t.materialIndex&&(t.materialIndex=[0])}function m({texture:e}){return m||mainComposite.loadedObjects.push(e),!0}function h({mesh:e}){return h||mainComposite.loadedObjects.push(e),!0}function g({mesh:e,heightData:t}){if(\"plane\"==geometryName)for(let n=0;n<e.geometry.vertices.length;n++)e.geometry.vertices[n].z=t[n]}const b=function({mesh:e,active:t,three:n}){return t&&b!=e?(n.scene.add(e),e):t||b!=e?void 0:(n.scene.remove(e),!1)},y=function({mesh:e,visible:t}){return e.visible=t,!0},w=function({mesh:e,shininess:t}){if(\"phong\"==materialName)if(1==T.length&&void 0===textureFileName&&void 0===F)e.material.shininess=t;else for(let n=0,i=T.length;n<i;++n)e.material[n].shininess=t},f=function({mesh:e,castShadow:t,receiveShadow:n}){e.castShadow=t,e.receiveShadow=n},x=function({mesh:e,position:t}){e.position.set(t.x,t.y,t.z)},N=function({mesh:e,quaternion:t}){return e.quaternion.set(t.x,t.y,t.z,t.w),!0},E=function({geometry:e,material:t,readyToCreateMesh:n}){return 1==t.length&&void 0===textureFileName&&void 0===F?new THREE.Mesh(e,t[0]):new THREE.Mesh(e,t)},T=function({materialName:e,dimension:t}){let n=[];switch(e){case\"lambert\":n.push(new THREE.MeshLambertMaterial);break;case\"basic\":n.push(new THREE.MeshBasicMaterial);break;case\"phong\":n.push(new THREE.MeshPhongMaterial);break;default:console.error(`materialName ${e} not found`)}return void 0===textureFileName&&void 0===F&&(readyToCreateMesh=!0),n},C=function({texture:e,material:t,geometry:n,materialIndex:i}){for(let n=0,i=e.length;n<i;++n)n>=t.length&&t.push(t[0].clone()),t[n].map=e[n];let a=0;switch(geometryName){case\"plane\":for(let e=0;e<n.faces.length;++e)n.faces[e].materialIndex=i[a],++a,a>=i.length&&(a=0);break;case\"box\":for(let e=0;e<n.faces.length;++e)n.faces[e].materialIndex=i[a],++a,a>=i.length&&(a=0);break;case\"sphere\":for(let e=0;e<n.faces.length;++e)n.faces[e].materialIndex=i[a],++a,a>=i.length&&(a=0);break;case\"cylinder\":let e=dimension.radiusBottom,t=e/2,o=dimension.radiusTop,s=o/2;for(let a=0;a<n.faces.length;++a){let r=n.faces[a],l=!r.normal.x&&!r.normal.z;r.normal.y<-.98&&r.normal.y>-1.01&&l?(n.faceVertexUvs[0][a][0].u=(n.vertices[r.a].x+t)/e,n.faceVertexUvs[0][a][0].v=(n.vertices[r.a].z+t)/e,n.faceVertexUvs[0][a][1].u=(n.vertices[r.b].x+t)/e,n.faceVertexUvs[0][a][1].v=(n.vertices[r.b].z+t)/e,n.faceVertexUvs[0][a][2].u=(n.vertices[r.c].x+t)/e,n.faceVertexUvs[0][a][2].v=(n.vertices[r.c].z+t)/e,r.materialIndex=3==i.length?i[2]:0):r.normal.y>.98&&r.normal.y<1.01&&l?(n.faceVertexUvs[0][a][0].u=(n.vertices[r.a].x+s)/o,n.faceVertexUvs[0][a][0].v=(n.vertices[r.a].z+s)/o,n.faceVertexUvs[0][a][1].u=(n.vertices[r.b].x+s)/o,n.faceVertexUvs[0][a][1].v=(n.vertices[r.b].z+s)/o,n.faceVertexUvs[0][a][2].u=(n.vertices[r.c].x+s)/o,n.faceVertexUvs[0][a][2].v=(n.vertices[r.c].z+s)/o,r.materialIndex=3==i.length?i[0]:0):r.materialIndex=3==i.length?i[1]:0}break;case\"polyhedron\":for(let e=0;e<n.faces.length;++e)n.faces[e].materialIndex=i[a],++a,a>=i.length&&(a=0);default:console.error(`geometryName ${geometryName} not found`)}return readyToCreateMesh=!0,!0},v=function({geometryName:e,dimension:t}){let n;switch(e){case\"plane\":n=new THREE.PlaneGeometry(t.length,t.width,t.xSeg,t.Yseg);break;case\"box\":n=new THREE.BoxGeometry(t.length,t.width,t.height);break;case\"sphere\":n=new THREE.SphereGeometry(t.radius,widthSegments,heightSegments);break;case\"cylinder\":n=new THREE.CylinderGeometry(t.radiusTop,t.radiusBottom,t.height,radialSegments,cylinderHeightSegments);break;case\"polyhedron\":t.radius||(t.radius=1),void 0===t.detail&&(t.detail=1),n=new THREE.PolyhedronGeometry(t.vertices,t.faces,t.radius,t.detail);break;default:console.error(`geometryName ${e} not found`)}return n},j=function({scale:e,mesh:t}){return t.scale.set(e,e,e),!0},R=function({color:e,mesh:t}){if(T.length>0)for(let t=0,n=T.length;t<n;++t)T[t].color.setHex(e);return!0},F=async function({textureFileName:e}){let t=[],n=[];Array.isArray(e)?n=[...e]:n.push(e);for(let e=0,i=n.length;e<i;++e)t.push(await(new THREE.TextureLoader).load(n[e])),t[t.length-1].anisotropy=16;return t};function P(e,t){t.cannon=e.cannon.getProxyLessObject,t.collisionGroupsNames=e.collisionGroupsNames.getProxyLessObject,t.materials=e.physicSettings.materials.getProxyLessObject,t.mainComposite=e,t.self=t,t.totalConstraints=0,t.physicMaterial||(t.physicMaterial=\"objectMaterial\"),t.linearDamping||(t.linearDamping=.15),t.angularDamping||(t.angularDamping=.15),t.allowSleep||(t.allowSleep=!1),t.cylinderSegments||(t.cylinderSegments=16),void 0===t.physicStatus&&(t.physicStatus=!0),null==t.sleep&&(t.sleep=!1),null==t.bodyType&&(t.bodyType=\"dynamic\"),null==t.groupName&&(t.groupName=\"all\"),null==t.collisionGroups&&(t.collisionGroups=[\"all\"]),t.addFunction(q),t.addFunction(D),t.addFunction(B),t.addFunction(A),t.addFunction(Q),t.addFunction(k),t.addFunction(V),t.addFunction(O),t.addFunction(z),t.addFunction(M),t.addFunction(H),t.addFunction(L),t.addFunction(S)}function S({reset:e,body:t}){t.linearDamping=linearDamping,t.angularDamping=angularDamping,t.position.set(position.x,position.y,position.z),t.previousPosition.set(position.x,position.y,position.z),t.interpolatedPosition.set(position.x,position.y,position.z),t.initPosition.set(position.x,position.y,position.z),t.quaternion.set(quaternion.x,quaternion.y,quaternion.z,quaternion.w),t.initQuaternion.set(quaternion.x,quaternion.y,quaternion.z,quaternion.w),t.interpolatedQuaternion.set(quaternion.x,quaternion.y,quaternion.z,quaternion.w),t.velocity.setZero(),t.initVelocity.setZero(),t.angularVelocity.setZero(),t.initAngularVelocity.setZero(),t.force.setZero(),t.torque.setZero(),t.sleepState=0,t.timeLastSleepy=0,t._wakeUpAfterNarrowphase=!1}function H({collisionGroupCode:e,contactGroupsMask:t,body:n}){n.collisionFilterGroup=e,n.collisionFilterMask=t}function z({groupName:e}){return collisionGroupsNames.includes(e)||collisionGroupsNames.push(e),Math.pow(2,collisionGroupsNames.indexOf(e))}function M({collisionGroups:e}){let t=0;for(let n of e){if(collisionGroupsNames.includes(n)||collisionGroupsNames.push(n),\"all\"==n)return-1;t|=Math.pow(2,collisionGroupsNames.indexOf(n))}return t}function O({body:e,allowSleep:t}){e.allowSleep=t}function V({body:e}){return addToLoadedObjects||mainComposite.loadedObjects.push(e),!0}function k({sleep:e}){e?timeStamp&&mainComposite.removeLink(self.timeStamp):mainComposite.addLink(mainComposite.timeStamp,self.timeStamp)}const A=function({timeStamp:e,body:t}){let n=t.position,i=t.quaternion;position=n,quaternion=i};function B({materials:e,physicMaterial:t}){return t in e?e[t]:void 0}function Q({body:e,physicStatus:t,totalConstraints:n}){if(t&&!Q)return cannon.addBody(e),!0;!Q||t||null!=L&&L||0!=n||mainComposite.getProxyLessObject.removeBodies.push(e)}function L({body:e,collisionCallback:t,enableCollisionCallback:n}){return n&&!L?(e.addEventListener(\"collide\",t),!0):L&&!n?(e.removeEventListener(\"collide\"),physicStatus=physicStatus,!1):void 0}function D({mesh:e,getMaterial:t,shape:n,mass:i}){if(D)return D;let a=new CANNON.Body({mass:i,shape:n,material:t,allowSleep:allowSleep});switch(bodyType){case\"dynamic\":a.type=CANNON.Body.DYNAMIC;break;case\"kinematic\":a.type=CANNON.Body.KINEMATIC;break;case\"static\":a.type=CANNON.Body.STATIC}return reset=!0,a}function q({geometryName:e,dimension:t,scale:n}){let i;switch(e){case\"plane\":i=heightData?new CANNON.Heightfield(heightData,{elementSize:t.width/t.xSeg}):new CANNON.Plane;break;case\"box\":i=new CANNON.Box(new CANNON.Vec3(t.length*n/2,t.width*n/2,t.height*n/2));break;case\"sphere\":i=new CANNON.Sphere(t.radius*n);break;case\"cylinder\":i=new CANNON.Cylinder(t.radiusTop,t.radiusBottom,t.height,cylinderSegments);let e=new CANNON.Quaternion;e.setFromAxisAngle(new CANNON.Vec3(1,0,0),-Math.PI/2);let a=new CANNON.Vec3(0,0,0);i.transformAllPoints(a,e);break;case\"polyhedron\":let o=[],s=[];for(let e=0,n=t.vertices.length/3;e<n;++e)o.push(new CANNON.Vec3(t.vertices[e],t.vertices[e+1],t.vertices[e+2]));for(let e=0,n=t.faces.length/3;e<n;++e)s.push([t.faces[e],t.faces[e+1],t.faces[e+2]]);i=new CANNON.ConvexPolyhedron(o,s)}return i}function I({setGeometries:e}){return I||mainComposite.loadedObjects.push(selfProxy),!0}function W({WorldPosition:e,worldDimension:t,allLoaded:n,thickness:i}){let a=t.x,o=t.y,s=t.z,r=i;return selfProxy.components[1].position={x:0,y:0,z:-s/2},selfProxy.components[1].dimension={length:a*scale,width:o*scale,height:r*scale},selfProxy.components[0].position={x:0,y:0,z:s/2},selfProxy.components[0].dimension={length:a*scale,width:o*scale,height:r*scale},selfProxy.components[4].position={x:0,y:o/2,z:0},selfProxy.components[4].dimension={length:a*scale,width:r*scale,height:s*scale},selfProxy.components[5].position={x:0,y:-o/2,z:0},selfProxy.components[5].dimension={length:a*scale,width:r*scale,height:s*scale},selfProxy.components[2].position={x:-a/2,y:0,z:0},selfProxy.components[2].dimension={length:r*scale,width:o*scale,height:s*scale},selfProxy.components[3].position={x:+a/2,y:0,z:0},selfProxy.components[3].dimension={length:r*scale,width:o*scale,height:s*scale},!0}const G=function({texture0:e,texture1:t,texture2:n,texture3:i,texture4:a,texture5:o}){return!0};async function U(e){let t,n=0;e.running=!0,e.cannonSafeStep=.016;let i=e.cannonSafeStep;function a(n){let o=e.actualInterval;o+=(n-t)/1e3,o>=i&&!1===e.compositeRunningFunctions&&(e.set({timeStamp:n,actualInterval:o,rendering:!0,framesInterval:n-t}),t=n),requestAnimationFrame(a)}requestAnimationFrame((function o(s){if(e.startUp)return;let r=e.actualInterval;if(n>2)return setTimeout(()=>{document.getElementById(\"loading\").classList.add(\"hide\")},1e3),document.body.appendChild(e.three.renderer.domElement.getProxyLessObject),e.startUp=s,void requestAnimationFrame(a);void 0===t&&(t=s),r+=(s-t)/1e3,r>=i&&!1===e.compositeRunningFunctions&&(e.set({timeStamp:s,actualInterval:r,rendering:!0,framesInterval:s-t}),++n),t=s,setTimeout(()=>{requestAnimationFrame(o)},250)}))}const Z={frameRate:60,maxSubStep:3};function _({light:e}){return _||mainComposite.loadedObjects.push(e),!0}function X({light:e,intensity:t}){return e.intensity=t,!0}function $({light:e,color:t}){return e.color=new THREE.Color(t),!0}function K({light:e,position:t}){e.position.x=t.x,e.position.y=t.y,e.position.z=t.z}function Y({light:e,targetPosition:t,castShadow:n,shadowMapDarkness:i,shadowMapSizeWidth:a,shadowMapSizeHeight:o,shadowCameraNear:s,shadowCameraFar:r,skyColor:l,groundColor:c,distance:d,width:u,height:p}){return\"spot\"!=lightType&&\"directional\"!=lightType&&\"point\"!=lightType||(e.castShadow=n,e.shadowMapDarkness=i,e.shadow.mapSize.width=a,e.shadow.mapSize.height=o,e.shadow.camera.near=s,e.shadow.camera.far=r),\"directional\"==lightType&&(e.target.position.x=t.x,e.target.position.y=t.y,e.target.position.z=t.z),\"hemisphere\"==lightType&&(e.skyColor=new THREE.Color(l),e.groundColor=new THREE.Color(c)),\"point\"!=lightType&&\"spot\"!=lightType||(e.distance=d),\"rectangular\"==lightType&&(e.width=u,e.height=p,e.lookAt(t)),!0}function J({lightType:e}){let t;switch(e){case\"ambient\":t=new THREE.AmbientLight(color,intensity);break;case\"spot\":t=new THREE.SpotLight(color,intensity);break;case\"directional\":t=new THREE.DirectionalLight(color,intensity);break;case\"hemisphere\":t=new THREE.HemisphereLight(skyColor,groundColor,intensity);break;case\"point\":t=new THREE.PointLight(color,intensity,distance);break;case\"rectangular\":t=new THREE.RectAreaLight(color,intensity,width,height);let e=new THREE.RectAreaLightHelper(t);t.add(e)}return t}function ee({light:e,visible:t}){t&&ee!=e&&three.scene.add(e),t||ee!=e||three.scene.remove(e)}function te({contactMaterials:e}){for(let t of e)if(!t.added){let e=materials[t.material1],n=materials[t.material2];e.name=t.material1,n.name=t.material2,cannon.addContactMaterial(new CANNON.ContactMaterial(e,n,{friction:t.friction,restitution:t.restitution})),t.added=!0}}const ne=function(){let e=new CANNON.World;e.broadphase=new CANNON.NaiveBroadphase;let t=new CANNON.GSSolver;return e.solver=new CANNON.SplitSolver(t),e.allowSleep=!0,e.solver.iterations=7,e.solver.tolerance=.01,e.defaultContactMaterial.contactEquationStiffness=1e6,e.defaultContactMaterial.contactEquationRelaxation=10,e.defaultContactMaterial.friction=.2,e},ie=function({gravity:e,cannon:t}){return t.gravity.set(e.x,e.y,e.z),!0};function ae({addToCompoundBody:e}){return addToLoadedObjects||mainComposite.loadedObjects.push(q),!0}function oe({body:e,shape:t}){if(oe)return oe;let n=e.position,i=new THREE.Quaternion(e.quaternion.x,e.quaternion.y,e.quaternion.z,e.quaternion.w),a=new THREE.Quaternion(quaternion.x,quaternion.y,quaternion.z,quaternion.w),o=new THREE.Vector3(position.x-n.x,position.y-n.y,position.z-n.z);return i.normalize().inverse(),o.applyQuaternion(i),a.multiply(i),compoundBodyShapeNumber=e.shapes.length,e.addShape(t,new CANNON.Vec3(o.x,o.y,o.z),new CANNON.Quaternion(a.x,a.y,a.z,a.w)),t}const se=function({timeStamp:e,body:t}){let n=t.position,i=t.quaternion;position=n,quaternion=i;for(let e of components){let a=e.compoundBodyShapeNumber,o=t.shapeOffsets[a],s=t.shapeOrientations[a];if(s&&o){let t=new THREE.Quaternion(i.x,i.y,i.z,i.w),a=new THREE.Quaternion(s.x,s.y,s.z,s.w),r=new THREE.Vector3(o.x,o.y,o.z);r.applyQuaternion(t),t.multiply(a),e.mesh.position.set(r.x+n.x,r.y+n.y,r.z+n.z),e.mesh.quaternion.set(t.x,t.y,t.z,t.w)}}};function re({bodies:e}){for(let t of e)linkedBodies.push(void 0),proxiedComposite.addLink(t.body,selfProxy.linkedBodies[linkedBodies.length-1]);return!0}function le({linkedBodies:e}){let t=void 0;for(let n=addedIndex;n<e.length;++n){if(!e[n])return;t?(constraints.push(new CANNON.LockConstraint(e[n],t,{maxForce:maxForce})),mainComposite.loadedObjects.push(constraints[constraints.length-1]),t=e[n],addedIndex=n):t=e[n]}return!0}function ce({active:e,addLockConstraint:t}){if(e&&!ce){for(let e of constraints)cannon.addConstraint(e),e.enable();for(let e of bodies)++e.self.totalConstraints;return!0}if(!e&&ce){for(let e of constraints)e.disable(),cannon.removeConstraint(e);for(let e of bodies)--e.self.totalConstraints;return!1}}function de({pointConstraint:e}){return de||mainComposite.loadedObjects.push(e),!0}function ue({bodyA:e}){return proxiedComposite.addLink(e.body,selfProxy.bodyABody),!0}function pe({bodyB:e}){return proxiedComposite.addLink(e.body,selfProxy.bodyBBody),!0}function me({offsetA:e}){return new CANNON.Vec3(e.x,e.y,e.z)}function he({offsetB:e}){return new CANNON.Vec3(e.x,e.y,e.z)}function ge({bodyABody:e,bodyBBody:t,pivotA:n,pivotB:i,maxForce:a,cannon:o}){if(ge)return ge;return new CANNON.PointToPointConstraint(e,n,t,i,a)}function be({active:e,pointConstraint:t}){return e&&!be?(cannon.addConstraint(t),t.enable(),++bodyA.self.totalConstraints,++bodyB.self.totalConstraints,!0):!e&&be?(t.disable(),cannon.removeConstraint(t),--bodyA.self.totalConstraints,--bodyB.self.totalConstraints,!1):void 0}function ye({distanceConstraint:e}){return ye||mainComposite.loadedObjects.push(e),!0}function we({bodyA:e}){return proxiedComposite.addLink(e.body,selfProxy.bodyABody),!0}function fe({bodyB:e}){return proxiedComposite.addLink(e.body,selfProxy.bodyBBody),!0}function xe({bodyABody:e,bodyBBody:t,maxForce:n,cannon:i}){if(xe)return xe;let a=new CANNON.DistanceConstraint(e,t);return distance&&(a.distance=distance),a.maxForce=n,a}function Ne({active:e,distanceConstraint:t}){return e&&!Ne?(cannon.addConstraint(t),t.enable(),++bodyA.self.totalConstraints,++bodyB.self.totalConstraints,!0):!e&&Ne?(t.disable(),cannon.removeConstraint(t),--bodyA.self.totalConstraints,--bodyB.self.totalConstraints,!1):void 0}function Ee({hingeConstraint:e}){return Ee||mainComposite.loadedObjects.push(e),!0}function Te({bodyA:e}){return proxiedComposite.addLink(e.body,selfProxy.bodyABody),!0}function Ce({bodyB:e}){return proxiedComposite.addLink(e.body,selfProxy.bodyBBody),!0}function ve({offsetA:e}){return new CANNON.Vec3(e.x,e.y,e.z)}function je({offsetB:e}){return new CANNON.Vec3(e.x,e.y,e.z)}function Re({bodyABody:e,bodyBBody:t,pivotA:n,pivotB:i,maxForce:a,cannon:o}){if(Re)return Re;let s=new CANNON.HingeConstraint(e,t,{pivotA:n,pivotB:i,maxForce:a});return axisA&&(s.axisA=axisA),axisB&&(s.axisB=axisB),s}function Fe({active:e,hingeConstraint:t}){return e&&!Fe?(cannon.addConstraint(t),t.enable(),++bodyA.self.totalConstraints,++bodyB.self.totalConstraints,!0):!e&&Fe?(t.disable(),cannon.removeConstraint(t),--bodyA.self.totalConstraints,--bodyB.self.totalConstraints,!1):void 0}function Pe({motor:e,hingeConstraint:t}){return e?t.enableMotor():t.disableMotor(),!0}function Se({speed:e,hingeConstraint:t}){t.setMotorSpeed(e)}function He({chassis:e}){return proxiedComposite.addLink(e[0].body,proxiedComposite.vehicles[currentAddress[currentAddress.length-1]].chassisBody),!0}function ze({wheelForce:e,addToWorld:t,wheelSpeed:n}){for(let t=0;t<wheels.length;t++)wheels[t].engine&&(wheels[t].leftHand?(Me.constraints[t].enableMotor(),Me.constraints[t].setMotorMaxForce(e),Me.constraints[t].setMotorSpeed(n)):(Me.constraints[t].enableMotor(),Me.constraints[t].setMotorMaxForce(-1*e),Me.constraints[t].setMotorSpeed(-1*n))),wheels[t].steering&&(wheels[t].leftHand,Me.setSteeringValue(Math.PI/16,t));return!0}function Me({chassisBody:e}){return chassis.compoundPosition?position=new CANNON.Vec3(chassis.compoundPosition.x,chassis.compoundPosition.y,chassis.compoundPosition.z):position=new CANNON.Vec3(e.position.x,e.position.y,e.position.z),new CANNON.RigidVehicle({chassisBody:e})}function Oe({rigidVehicle:e,position:t}){e.position=new CANNON.Vec3(t.x,t.y,t.z)}function Ve({rigidVehicle:e,quaternion:t}){e.chassisBody.quaternion=new CANNON.Quaternion(t.x,t.y,t.z,t.w)}function ke({wheels:e}){for(let t of e)linkedWheelsBodies.push(void 0),proxiedComposite.addLink(t.body.body,proxiedComposite.vehicles[currentAddress[currentAddress.length-1]].linkedWheelsBodies[linkedWheelsBodies.length-1]);return!0}function Ae({rigidVehicle:e,linkedWheelsBodies:t}){for(let e of t)if(!e)return;for(let n=0,i=t.length;n<i;++n){let i=t[n],a=new CANNON.Vec3(i.position.x-position.x,i.position.y-position.y,i.position.z-position.z);e.addWheel({body:i,position:a,quaternion:i.quaternion,isFrontWheel:wheels[n].steering,frictionSlip:5,axis:wheels[n].axis,direction:wheels[n].direction})}for(let t=0;t<e.wheelBodies.length;t++)e.wheelBodies[t].angularDamping=.4;return!0}function Be({addWheelToVehicle:e,cannon:t}){return Me.addToWorld(t),!0}function Qe({wheels:e,addToWorld:t}){for(let t=0;t<e.length;t++)qe.applyEngineForce(e[t].engine,t),qe.setSteeringValue(e[t].steering,t),qe.setBrake(e[t].brake,t);return!0}function Le({chassis:e}){return proxiedComposite.addLink(e[0].body,proxiedComposite.vehicles[currentAddress[currentAddress.length-1]].chassisBody),!0}function De({timeStamp:e,addWheelToVehicle:t}){let n=new CANNON.Quaternion;n.setFromAxisAngle(new CANNON.Vec3(0,0,1).normalize(),Math.PI/2);for(let e=0;e<qe.wheelInfos.length;e++){qe.updateWheelTransform(e);let t=qe.wheelInfos[e].worldTransform;linkedWheelsBodies[e].position.copy(t.position),linkedWheelsBodies[e].quaternion=t.quaternion.mult(n)}}function qe({chassisBody:e}){return chassis.compoundPosition?position=new CANNON.Vec3(chassis.compoundPosition.x,chassis.compoundPosition.y,chassis.compoundPosition.z):position=new CANNON.Vec3(e.position.x,e.position.y,e.position.z),new CANNON.RaycastVehicle({chassisBody:e,indexForwardAxis:2,indexRightAxis:0,indexUpAxis:1})}function Ie({raycastVehicle:e,position:t}){e.position=new CANNON.Vec3(t.x,t.y,t.z)}function We({raycastVehicle:e,quaternion:t}){console.log(\"set quat\"),e.chassisBody.quaternion=new CANNON.Quaternion(t.x,t.y,t.z,t.w)}function Ge({wheels:e}){if(Ge)return!0;Ge=!0;for(let t of e)linkedWheelsBodies.push(void 0),proxiedComposite.addLink(t.body.body,proxiedComposite.vehicles[currentAddress[currentAddress.length-1]].linkedWheelsBodies[linkedWheelsBodies.length-1]);return!0}function Ue({raycastVehicle:e,linkedWheelsBodies:t}){if(Ue)return!0;for(let e of t)if(!e)return;for(let n=0,i=t.length;n<i;++n){let i=t[n];wheelOptions.chassisConnectionPointLocal=new CANNON.Vec3(i.position.x-position.x,i.position.y-position.y,i.position.z-position.z),wheelOptions.radius=wheels[n].body.dimension.radiusTop,e.addWheel(wheelOptions)}return!0}function Ze({addWheelToVehicle:e,cannon:t}){return qe.addToWorld(t),!0}function _e({turningLeft:e,turningRight:t,actualInterval:n}){if(!t&&!e)return!1;if(t){let e=steering+n*turningSpeed;e>absMaxSteering&&(e=absMaxSteering),steering=e}if(e){let e=steering-n*turningSpeed;e<-absMaxSteering&&(e=-absMaxSteering),steering=e}}function Xe({headBodiesLoaded:e,buildRoadTrain:t}){return Xe||(mainComposite.loadedObjects.push(e),mainComposite.loadedObjects.push(t)),!0}function $e({wheelsBodies:e,suspensionsBodies:t,chassisBody:n}){if($e)return!0;for(let t of e)if(!t)return;for(let e of t)if(!e)return;return!0}function Ke({wheelsInfo:e}){if(Ke)return!0;let t=self;wheels=[],wheelsBodies=[],suspensions=[],suspensionsBodies=[],cabinParts=[],gapRatio=.95;let n,i,a,o,s,r,l=position.x,c=position.y,d=position.z,u=new THREE.Quaternion(quaternion.x,quaternion.y,quaternion.z,quaternion.w),p=0,m=0;for(let e of t.wheelsInfo){let o=t.wheels;o.push({});let s=o[o.length-1],r=new THREE.Vector3(e.doubleWheelGap/2+(e.width-e.doubleWheelGap)/4,0,0),h=new THREE.Vector3(e.doubleWheelGap/2+(e.width-e.doubleWheelGap)/4,0,0),g=new THREE.Vector3(e.axelLength,e.radius-e.axelHeight,e.distance);e.left?(n=Math.PI/2,h.x=-h.x):(r.x=-r.x,g.x=-g.x,n=-Math.PI/2),s.localPos=new THREE.Vector3(g.x,g.y,g.z),g.applyQuaternion(u);let b=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,0,1).normalize(),n);s.correctionQuat=new THREE.Quaternion(b.x,b.y,b.z,b.w);let y=new THREE.Quaternion(u.x,u.y,u.z,u.w);y.multiply(b);let w=[],f=e.doubleWheelGap?e.axelDiameter:e.radius;mainComposite.utils.addObject(s),s.set({geometryName:\"cylinder\",dimension:{radiusTop:f,radiusBottom:f,height:.99*e.width},position:{x:l+g.x,y:c+g.y,z:d+g.z},color:e.color,quaternion:new THREE.Quaternion(y.x,y.y,y.z,y.w),materialName:\"basic\",shinines:0,textureFileName:e.textureFileName,materialIndex:[0,1,2],visible:!1,sleep:!0,groupName:\"wheel\",collisionGroups:[\"ground\",\"obstacle\"]}),w.push(s),e.doubleWheelGap&&(h.applyQuaternion(u),r.applyQuaternion(u),h.add(s.position),r.add(s.position),s.wheelIn={},mainComposite.utils.addObject(s.wheelIn),s.wheelIn.set({geometryName:\"cylinder\",dimension:{radiusTop:e.radius,radiusBottom:e.radius,height:(e.width-e.doubleWheelGap)/2},position:{x:h.x,y:h.y,z:h.z},color:e.color,quaternion:new THREE.Quaternion(y.x,y.y,y.z,y.w),materialName:\"lambert\",shinines:0,textureFileName:e.textureFileName,materialIndex:[0,1,2],visible:!1,sleep:!0}),w.push(s.wheelIn),s.wheelOut={},mainComposite.utils.addObject(s.wheelOut),s.wheelOut.set({geometryName:\"cylinder\",dimension:{radiusTop:e.radius,radiusBottom:e.radius,height:(e.width-e.doubleWheelGap)/2},position:{x:r.x,y:r.y,z:r.z},color:e.color,quaternion:new THREE.Quaternion(y.x,y.y,y.z,y.w),materialName:\"lambert\",shinines:0,textureFileName:e.textureFileName,materialIndex:[0,1,2],visible:!1,sleep:!0}),w.push(s.wheelOut));let x=(e.axelLength-e.width/2)*t.gapRatio;mainComposite.utils.makePhysicCompound(w),s.set({angularDamping:e.angularDamping,linearDamping:0,physicMaterial:e.wheelMaterial,mass:e.wheelMass,wheelLeft:e.left,wheelSteering:e.steering,driving:e.engine,stiffness:e.stiffness,damping:e.damping,springLenght:e.springLegth,allowSleep:!1,susLength:x,physicStatus:!1});let N=t.suspensions,E=new THREE.Vector3(e.axelLength-e.width/2-x/2,0,e.distance);e.left||(E.x*=-1),N.push({});let T=N[N.length-1];T.localSusPos=new THREE.Vector3(E.x,E.y,E.z),E.applyQuaternion(u),mainComposite.utils.addObject(T),T.set({geometryName:\"box\",dimension:{height:e.axelDiameter,width:e.axelDiameter,length:x},position:{x:l+E.x,y:c+E.y,z:d+E.z},quaternion:new THREE.Quaternion(u.x,u.y,u.z,u.w),color:e.susColor,materialName:\"basic\",shinines:0,visible:!1,sleep:!0}),mainComposite.utils.addPhysicBody(T),T.set({physicMaterial:e.axelMaterial,mass:e.axelMass,allowSleep:!1,physicStatus:!1,groupName:\"suspension\",collisionGroups:[\"chassis\"]}),e.distance+2*e.axelDiameter>p&&(p=e.distance+2*e.axelDiameter),e.distance-2*e.axelDiameter<m&&(m=e.distance-2*e.axelDiameter),a=2*(e.axelLength-e.radius),(!i||i>a)&&(i=a)}t.chassisWidth||(t.chassisWidth=i),t.chassisFrontLength||(t.chassisFrontLength=p),t.chassisRearLength||(t.chassisRearLength=m),t.chassisLength=t.chassisFrontLength-t.chassisRearLength,Math.abs(chassisFrontLength)<Math.abs(chassisRearLength)?(o=2*Math.abs(t.chassisFrontLength),r=-t.chassisFrontLength+(t.chassisRearLength+t.chassisFrontLength)/2):(o=2*Math.abs(t.chassisRearLength),r=-t.chassisRearLength+(t.chassisRearLength+t.chassisFrontLength)/2),s=t.chassisLength-o,t.chassisTop={},mainComposite.utils.addObject(t.chassisTop);let h=new THREE.Vector3(0,t.axelsVerticalFreedom,(t.chassisFrontLength+t.chassisRearLength)/2);h.applyQuaternion(u),t.chassisTop.set({geometryName:\"box\",dimension:{height:t.chassisLength,width:t.chassisTickness,length:t.chassisWidth},position:{x:l+h.x,y:c+h.y,z:d+h.z},quaternion:new THREE.Quaternion(u.x,u.y,u.z,u.w),color:t.chassisColor,textureFileName:[\"/textures/bed.png\"],materialName:\"lambert\",visible:!1,sleep:!0}),t.chassis={},mainComposite.utils.addObject(t.chassis);let g=new THREE.Vector3(0,-t.axelsVerticalFreedom,0);g.applyQuaternion(u),t.chassis.set({geometryName:\"box\",dimension:{height:o,width:t.chassisTickness,length:t.chassisWidth},position:{x:l+g.x,y:c+g.y,z:d+g.z},quaternion:new THREE.Quaternion(u.x,u.y,u.z,u.w),color:t.chassisColor,textureFileName:[\"/textures/bed.png\"],materialName:\"lambert\",visible:!1,sleep:!0,groupName:\"chassis\",collisionGroups:[\"suspension\",\"obstacle\",\"ground\",\"chassis\"],physicMaterial:\"chassisMaterial\"});let b=[t.chassis,t.chassisTop];if(0!=s){t.chassisExtension={},mainComposite.utils.addObject(t.chassisExtension);let e=new THREE.Vector3(0,-t.axelsVerticalFreedom,r);e.applyQuaternion(u),t.chassisExtension.set({geometryName:\"box\",dimension:{height:s,width:t.chassisTickness,length:t.chassisWidth},position:{x:l+e.x,y:c+e.y,z:d+e.z},quaternion:new THREE.Quaternion(u.x,u.y,u.z,u.w),color:t.chassisColor,textureFileName:[\"/textures/bed.png\"],materialName:\"lambert\",visible:!1,sleep:!0}),b.push(t.chassisExtension)}if(t.cabinInfo)for(let e of cabinInfo){t.cabinParts.push(e);let n=t.cabinParts[t.cabinParts.length-1];mainComposite.utils.addObject(n);let i=new THREE.Vector3(e.localPosition.x,e.localPosition.y,e.localPosition.z),a=new THREE.Quaternion(e.localQuaternion.x,e.localQuaternion.y,e.localQuaternion.z,e.localQuaternion.w);i.applyQuaternion(u),i.add(new THREE.Vector3(l,c,d)),a.multiply(u),n.set({position:i,quaternion:a,visible:!1,sleep:!0}),t.cabinPhysic?b.push(n):(mainComposite.addLink(t.position,n.chassisPos),mainComposite.addLink(t.quaternion,n.chassisQuat),mainComposite.addLink(t.chassis.visible,n.visible),mainComposite.addLink(mainComposite.timeStamp,n.timeStamp),n.addFunction(y))}mainComposite.utils.makePhysicCompound(b),t.chassis.set({mass:t.chassisMass,physicStatus:!1}),mainComposite.addLink(t.chassis.position,t.position),mainComposite.addLink(t.chassis.quaternion,t.quaternion);for(let e=0,n=t.wheels.length;e<n;++e)t.addLink(t.wheels[e].body,t.wheelsBodies[e]),t.addLink(t.suspensions[e].body,t.suspensionsBodies[e]);return t.addLink(t.chassis.body,t.chassisBody),!0;function y({chassisPos:e,chassisQuat:t,mesh:n,timeStamp:i}){let a=new THREE.Vector3(localPosition.x,localPosition.y,localPosition.z),o=new THREE.Quaternion(localQuaternion.x,localQuaternion.y,localQuaternion.z,localQuaternion.w),s=new THREE.Vector3(e.x,e.y,e.z),r=new THREE.Quaternion(t.x,t.y,t.z,t.w);a.applyQuaternion(r),a.add(s),o.multiply(r),n.position.set(a.x,a.y,a.z),n.quaternion.set(o.x,o.y,o.z,o.w)}}function Ye({setConstraint:e}){return Ye||mainComposite.loadedObjects.push(e),!0}function Je({towedRoadTrain:e}){roadTrain.addLink(e.chassis.body,roadTrain.frontTowing.otherBody),roadTrain.addLink(roadTrain.chassis.body,roadTrain.frontTowing.thisBody),roadTrain.addLink(roadTrain.enable,roadTrain.frontTowing.thisEnable),roadTrain.addLink(e.enable,roadTrain.frontTowing.otherEnable)}function et({thisTowingPosition:e,otherTowingPosition:t,thisBody:n,otherBody:i}){if(et)return et;let a=new CANNON.Vec3(e.x,e.y,e.z),o=new CANNON.Vec3(t.x,t.y,t.z);return constraint=new CANNON.PointToPointConstraint(n,a,i,o),constraint}function tt({setConstraint:e,thisEnable:t,otherEnable:n}){return e&&t&&n&&!tt?(roadTrain.cannon.addConstraint(e),!0):(tt&&roadTrain.cannon.removeConstraint(e),!1)}function nt(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.addFunction(it),t.self=t,t.mainComposite=e,t.cannon=e.cannon,e.addLink(e.actualInterval,t.actualInterval),function(e){e.turningSpeed=Math.PI/6/1.2,e.absMaxSteering=Math.PI/6,e.turningLeft=!1,e.turningRight=!1,e.drivingForward=!0,e.steering=0,e.touchSpan=200,e.addFunction(_e)}(t),function(e){e.frontTowing={roadTrain:e},e.frontTowing.constraint=void 0,e.frontTowing.mainComposite=e.mainComposite,e.frontTowing.addFunction(Je),e.frontTowing.addFunction(et),e.frontTowing.loadedObjects=e.mainComposite.loadedObjects.getProxyLessObject,e.frontTowing.addFunction(Ye),e.frontTowing.addFunction(tt)}(t),function(e){e.wheels=void 0,e.wheelsBodies=void 0,e.suspensions=void 0,e.suspensionsBodies=void 0,e.cabinParts=void 0,e.gapRatio=.95,e.position||(e.position={x:0,y:0,z:0}),e.quaternion||(e.quaternion={x:0,y:0,z:0,w:1}),e.addFunction(Ke),e.addFunction($e),e.addFunction(Xe)}(t),t.allWheels=[],t.axelSprings=[],t.enable||(t.enable=!1),t.suspensionRestLenght||(t.suspensionRestLenght=0),t.speed||(t.speed=0),t.engineForce||(t.engineForce=30),t.addFunction(ct),t.addFunction(rt),t.addFunction(st),t.addFunction(lt),t.addFunction(ot),t.addFunction(at)}function it({setHingeConstraints:e}){return it||mainComposite.loadedObjects.push(self),!0}function at({resetPos:e,resetQuat:t}){let n=new THREE.Vector3(0,-axelsVerticalFreedom,0);n.applyQuaternion(t),self.chassis.set({position:n.add(e),quaternion:t,reset:!0});for(let n=0,i=allWheels.length;n<i;++n){let i=t.clone(),a=new THREE.Vector3(wheels[n].localPos.x,wheels[n].localPos.y,wheels[n].localPos.z),o=new THREE.Quaternion(wheels[n].correctionQuat.x,wheels[n].correctionQuat.y,wheels[n].correctionQuat.z,wheels[n].correctionQuat.w);a.applyQuaternion(i),a.add(e),i.multiply(o),wheels[n].self.set({position:a,quaternion:i,reset:!0});let s=new THREE.Vector3(suspensions[n].localSusPos.x,suspensions[n].localSusPos.y,suspensions[n].localSusPos.z);i=t.clone(),s.applyQuaternion(i),s.add(e),suspensions[n].self.set({position:s,quaternion:i,reset:!0})}e=void 0,t=void 0}function ot({newPos:e,newQuat:t,setHingeConstraints:n,setNewPos:i}){if(enable)return!1;let a=new THREE.Vector3(0,-axelsVerticalFreedom,0);a.applyQuaternion(new THREE.Quaternion(t.x,t.y,t.z,t.w)),chassisBody.position=new CANNON.Vec3(a.x+e.x,a.y+e.y,a.z+e.z),chassisBody.quaternion=new CANNON.Quaternion(t.x,t.y,t.z,t.w);for(let n=0,i=allWheels.length;n<i;++n){let i=new THREE.Quaternion(t.x,t.y,t.z,t.w),a=new THREE.Vector3(wheels[n].localPos.x,wheels[n].localPos.y,wheels[n].localPos.z),o=new THREE.Quaternion(wheels[n].correctionQuat.x,wheels[n].correctionQuat.y,wheels[n].correctionQuat.z,wheels[n].correctionQuat.w);a.applyQuaternion(i),a.add(e),i.multiply(o),wheels[n].body.position=new CANNON.Vec3(a.x,a.y,a.z),wheels[n].body.quaternion=new CANNON.Quaternion(i.x,i.y,i.z,i.w);let s=new THREE.Vector3(suspensions[n].localSusPos.x,suspensions[n].localSusPos.y,suspensions[n].localSusPos.z);i=new THREE.Quaternion(t.x,t.y,t.z,t.w),s.applyQuaternion(i),s.add(e),suspensions[n].body.position=new CANNON.Vec3(s.x,s.y,s.z),suspensions[n].body.quaternion=new CANNON.Quaternion(i.x,i.y,i.z,i.w)}enable=!0}function st({roadtrainStatus:e,engineForce:t,speed:n}){if(e)for(let e of allWheels)if(e.driving){let i=e.wheelConstraint;0==t?i.disableMotor():(i.setMotorMaxForce(t),e.isLeft?i.setMotorSpeed(n):i.setMotorSpeed(-n),i.enableMotor())}}function rt({steering:e,roadtrainStatus:t}){if(t){let t=Math.cos(e),n=Math.sin(e);for(let e of allWheels)e.steering&&(e.isLeft?(e.wheelConstraint.axisA.x=t,e.wheelConstraint.axisA.z=n):(e.wheelConstraint.axisA.x=-t,e.wheelConstraint.axisA.z=-n),e.wheelConstraint.update())}}function lt({setHingeConstraints:e,enable:t}){if(t&&lt)return!0;if(!t&&!lt)return!1;if(t&&!lt){for(let e=0,t=allWheels.length;e<t;++e)self.wheels[e].set({visible:!0,physicStatus:!0,sleep:!1,enableCollisionCallback:!0}),self.suspensions[e].set({visible:!0,physicStatus:!0,sleep:!1,enableCollisionCallback:!0}),cannon.addConstraint(allWheels[e].wheelConstraint),cannon.addConstraint(allWheels[e].suspensionConstraint),allWheels[e].wheelConstraint.rotationalEquation1.setSpookParams(1e10,4,1/120),allWheels[e].wheelConstraint.rotationalEquation2.setSpookParams(1e10,4,1/120),allWheels[e].suspensionConstraint.rotationalEquation1.setSpookParams(1e10,4,1/120),allWheels[e].suspensionConstraint.rotationalEquation2.setSpookParams(1e10,4,1/120);return self.chassis.set({visible:!0,physicStatus:!0,sleep:!1,enableCollisionCallback:!0}),!0}if(!t&&lt){for(let e=0,t=allWheels.length;e<t;++e)self.wheels[e].set({visible:!1,physicStatus:!1,sleep:!0,enableCollisionCallback:!1}),self.suspensions[e].set({visible:!1,physicStatus:!1,sleep:!0,enableCollisionCallback:!1}),cannon.removeConstraint(allWheels[e].wheelConstraint),cannon.removeConstraint(allWheels[e].suspensionConstraint);return self.chassis.set({visible:!1,physicStatus:!1,sleep:!0,enableCollisionCallback:!1}),!1}}function ct({headBodiesLoaded:e,cannon:t}){if(ct)return!0;let n,i,a=new CANNON.Vec3(0,0,0),o=new THREE.Quaternion(chassisBody.quaternion.x,chassisBody.quaternion.y,chassisBody.quaternion.z,chassisBody.quaternion.w).normalize().inverse();for(let e=0,t=wheelsBodies.length;e<t;++e){let t={},s=new THREE.Vector3(wheelsBodies[e].position.x-suspensionsBodies[e].position.x,wheelsBodies[e].position.y-suspensionsBodies[e].position.y,wheelsBodies[e].position.z-suspensionsBodies[e].position.z);s.applyQuaternion(o),wheels[e].wheelLeft&&(t.isLeft=!0,n=new CANNON.Vec3(1,0,0),i=new CANNON.Vec3(0,1,0)),wheels[e].wheelLeft||(t.isLeft=!1,n=new CANNON.Vec3(-1,0,0),i=new CANNON.Vec3(0,1,0)),t.wheelConstraint=new CANNON.HingeConstraint(suspensionsBodies[e],wheelsBodies[e],{pivotA:new CANNON.Vec3(s.x,s.y,s.z),axisA:n,pivotB:a,axisB:i,maxForce:1e6,collideConnected:!1}),t.wheelConstraint.collideConnected=!1,wheels[e].wheelSteering?t.steering=!0:t.steering=!1,wheels[e].driving?t.driving=!0:t.driving=!1;let r=new THREE.Vector3(suspensionsBodies[e].position.x-chassisBody.position.x,suspensionsBodies[e].position.y-chassisBody.position.y,suspensionsBodies[e].position.z-chassisBody.position.z);r.applyQuaternion(o);let l=new THREE.Vector3(-n.x*wheels[e].susLength,0,0),c=new THREE.Vector3(l.x,0,0),d=new THREE.Vector3(c.x+r.x,c.y+r.y,c.z+r.z);t.suspensionConstraint=new CANNON.HingeConstraint(chassisBody,suspensionsBodies[e],{pivotA:new CANNON.Vec3(d.x,d.y,d.z),axisA:new CANNON.Vec3(0,0,1),pivotB:new CANNON.Vec3(l.x,l.y,l.z),axisB:new CANNON.Vec3(0,0,1),maxForce:1e6});let u=new THREE.Vector3(wheelsBodies[e].position.x-chassisBody.position.x,wheelsBodies[e].position.y-chassisBody.position.y,wheelsBodies[e].position.z-chassisBody.position.z);u.applyQuaternion(o),u.y=u.y-wheels[e].springLenght,axelSprings.push(new CANNON.Spring(chassisBody,suspensionsBodies[e],{restLength:suspensionRestLenght,stiffness:wheels[e].stiffness,damping:wheels[e].damping,localAnchorA:new CANNON.Vec3(u.x,u.y,u.z),localAnchorB:s})),allWheels.push(t)}return t.addEventListener(\"postStep\",(function(e){if(lt)for(let e=0,t=axelSprings.length;e<t;++e)axelSprings[e].applyForce()})),!0}const dt=function({timeStamp:e,three:t,activeCamera:n,cannon:i}){t.renderer.render(t.scene,n);let a=actualInterval,o=cannonSafeStep;for(removeBodies.length>0&&i.remove(removeBodies.pop());a>=o;)i.step(o),a-=o;return actualInterval=a,!0};function ut({cameraTransitionPlot:e,newAnimationFrame:t}){let n=cameras.cameraT.camera;if(0==e.length&&null==transitionData)return void(e=void 0);if(activeCamera!=n&&(self.cameras.cameraT.active=!0),null==transitionData){let t=e.shift(),i=t.startCam.getProxyLessObject.camera;transitionData={endCam:t.endCam.getProxyLessObject.camera,proxyEndCam:t.endCam,movingSpeed:t.movingSpeed,rotatingSpeed:t.rotatingSpeed,movingType:t.movingType,rotatingType:t.rotatingType,startTime:timeStamp},n.position.x=i.position.x,n.position.y=i.position.y,n.position.z=i.position.z,n.quaternion.x=i.quaternion.x,n.quaternion.y=i.quaternion.y,n.quaternion.z=i.quaternion.z,n.quaternion.w=i.quaternion.w}let i=(timeStamp-transitionData.startTime)/transitionData.movingSpeed,a=(timeStamp-transitionData.startTime)/transitionData.rotatingSpeed;i=Math.pow(i,transitionData.movingType),a=Math.pow(a,transitionData.rotatingType);let o=n.position,s=n.quaternion;s.slerp(transitionData.endCam.quaternion,i>1?1:i),o.lerp(transitionData.endCam.position,a>1?1:a),o.distanceToSquared(transitionData.endCam.position)<.01&&s.angleTo(transitionData.endCam.quaternion)<.01&&(transitionData.proxyEndCam.active=!0,transitionData=void 0)}function pt({newAnimationFrame:e}){if(startUp)return;let t=cameras.camera3.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=roadTrains[0].quaternion,a=roadTrains[0].visibleTrailers+1,o=t.position,s=new THREE.Vector3(0,0,-10*a);s.applyQuaternion(i),o.x=s.x+n.x,o.y=s.y+n.y+2+2*a,o.z=s.z+n.z,t.lookAt(new THREE.Vector3(n.x,n.y,n.z))}function mt({newAnimationFrame:e}){if(startUp)return;let t=cameras.camera11.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=roadTrains[0].quaternion,a=roadTrains[0].visibleTrailers+1,o=t.position,s=new THREE.Vector3(0,0,-10*a);s.applyQuaternion(i),o.x=s.x+n.x,o.y=s.y+n.y+2+2*a,o.z=s.z+n.z,t.lookAt(new THREE.Vector3(n.x,n.y,n.z))}function ht({newAnimationFrame:e}){if(startUp)return;let t=cameras.camera12.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=roadTrains[0].quaternion,a=roadTrains[0].visibleTrailers+1,o=t.position,s=new THREE.Vector3(0,0,-10*a);s.applyQuaternion(i),o.x=s.x+n.x,o.y=s.y+n.y+2+2*a,o.z=s.z+n.z,t.lookAt(new THREE.Vector3(n.x,n.y,n.z))}function gt({newAnimationFrame:e}){let t=cameras.camera7.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=roadTrains[0].quaternion,a=t.position,o=new THREE.Vector3(0,4,12);o.applyQuaternion(i),a.x=o.x+n.x,a.y=o.y+n.y,a.z=o.z+n.z,t.lookAt(new THREE.Vector3(n.x,n.y,n.z))}function bt({newAnimationFrame:e}){let t=cameras.camera8.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=new THREE.Quaternion(roadTrains[0].quaternion.x,roadTrains[0].quaternion.y,roadTrains[0].quaternion.z,roadTrains[0].quaternion.w),a=t.position,o=new THREE.Vector3(2,1.5,-15),s=new THREE.Vector3(2,1.5,12);s.applyQuaternion(i),s.add(n),o.applyQuaternion(i),a.x=o.x+n.x,a.y=o.y+n.y,a.z=o.z+n.z,t.lookAt(new THREE.Vector3(s.x,s.y,s.z))}function yt({newAnimationFrame:e}){let t=cameras.camera9.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=roadTrains[0].quaternion,a=roadTrains[0].visibleTrailers+1,o=t.position,s=new THREE.Vector3(0,0,-10*a);s.applyQuaternion(i),o.x=s.x+n.x,o.y=-502,o.z=s.z+n.z-10,t.lookAt(new THREE.Vector3(n.x,n.y,n.z))}function wt({newAnimationFrame:e}){let t=cameras.camera10.camera;if(activeCamera!=t&&activeCamera!=cameras.cameraT.camera)return;let n=roadTrains[0].position,i=roadTrains[0].quaternion,a=t.position,o=new THREE.Vector3(0,4,2),s=new THREE.Vector3(0,2,8);s.applyQuaternion(i),s.add(n),o.applyQuaternion(i),a.x=o.x+n.x,a.y=o.y+n.y,a.z=o.z+n.z,t.lookAt(s)}function ft(){let e=[\"/textures/tyreInside.png\",\"/textures/tyreTexture.png\",\"/textures/tyreOutside.png\"],t=16777215,n=[];return n.push({radius:.65,width:.3,axelLength:1.63,axelHeight:.8,axelDiameter:.15,distance:3.1,stiffness:220,damping:60,springLegth:.8,steering:!0,engine:!0,left:!0,wheelMass:1,axelMass:25,textureFileName:e,color:t,susColor:3355443,wheelMaterial:\"frontWheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0}),n.push({radius:.65,width:.3,axelLength:1.63,axelHeight:.8,axelDiameter:.15,distance:3.1,stiffness:220,damping:60,springLegth:.8,steering:!0,engine:!0,left:!1,wheelMass:1,axelMass:25,textureFileName:e,color:t,susColor:3355443,wheelMaterial:\"frontWheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0}),n.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.15,distance:-1.9,stiffness:170,damping:30,springLegth:.8,steering:!1,engine:!0,left:!0,wheelMass:1,axelMass:25,textureFileName:e,color:t,susColor:3355443,wheelMaterial:\"fakeWheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),n.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.15,distance:-1.9,stiffness:170,damping:30,springLegth:.8,steering:!1,engine:!0,left:!1,wheelMass:1,axelMass:25,textureFileName:e,susColor:3355443,color:t,wheelMaterial:\"fakeWheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),n.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.15,distance:-3.5,stiffness:170,damping:30,springLegth:.8,steering:!1,engine:!0,left:!0,wheelMass:1,axelMass:25,textureFileName:e,susColor:3355443,color:t,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),n.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.15,distance:-3.5,stiffness:170,damping:30,springLegth:.8,steering:!1,engine:!0,left:!1,wheelMass:1,axelMass:25,textureFileName:e,susColor:3355443,color:t,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),n}function xt(){let e=[\"/textures/tyreInside.png\",\"/textures/tyreTexture.png\",\"/textures/tyreOutside.png\"],t=[];return t.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:.5,stiffness:70,damping:30,springLegth:.8,steering:!1,engine:!1,left:!0,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),t.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:.5,stiffness:70,damping:30,springLegth:.8,steering:!1,engine:!1,left:!1,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),t.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:-1.5,stiffness:70,damping:30,springLegth:.8,steering:!1,engine:!1,left:!0,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),t.push({radius:.65,width:.6+.07,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:-1.5,stiffness:70,damping:30,springLegth:.8,steering:!1,engine:!1,left:!1,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0,doubleWheelGap:.07}),t}function Nt(){let e=[\"/textures/tyreInside.png\",\"/textures/tyreTexture.png\",\"/textures/tyreOutside.png\"],t=[];return t.push({radius:.65,width:.3,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:7,stiffness:40,damping:30,springLegth:.8,steering:!1,engine:!1,left:!0,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0}),t.push({radius:.65,width:.3,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:7,stiffness:40,damping:30,springLegth:.8,steering:!1,engine:!1,left:!1,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0}),t.push({radius:.65,width:.3,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:-1.5,stiffness:40,damping:30,springLegth:.8,steering:!1,engine:!1,left:!0,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0}),t.push({radius:.65,width:.3,axelLength:1.4,axelHeight:.8,axelDiameter:.1,distance:-1.5,stiffness:40,damping:30,springLegth:.8,steering:!1,engine:!1,left:!1,wheelMass:1,axelMass:5,textureFileName:e,susColor:3355443,color:16777215,wheelMaterial:\"wheelMaterial\",axelMaterial:\"objectMaterial\",angularDamping:0}),t}function Et(){let e=[];return e.push({geometryName:\"box\",dimension:{height:4,width:2,length:2.1},localPosition:new THREE.Vector3(0,1.1,2.6),localQuaternion:new THREE.Quaternion(0,0,0,1),color:16777215,materialName:\"lambert\",textureFileName:[\"/textures/bodyColor.png\",\"/textures/hoodFront.png\"],materialIndex:[0,0,0,0,0,0,0,0,1,1,0,0],groupName:\"cabin\"}),e.push({geometryName:\"box\",dimension:{height:2,width:2.7,length:2.4},localPosition:new THREE.Vector3(0,1.5,1.3),localQuaternion:new THREE.Quaternion(0,0,0,1),color:16777215,materialName:\"lambert\",textureFileName:[\"/textures/cabinLeft.png\",\"/textures/cabinRight.png\",\"/textures/bodyColor.png\",\"/textures/bodyColor.png\",\"/textures/windShield.png\",\"/textures/bodyColor.png\"],materialIndex:[0,0,1,1,3,3,3,3,4,4,3,3]}),e.push({geometryName:\"box\",dimension:{height:.1,width:.5,length:3.4},localPosition:new THREE.Vector3(0,0,-4.35),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/bodyColor.png\",\"/textures/backLights.png\"],materialIndex:[0,0,0,0,0,0,0,0,0,0,1,1],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:.52,width:1.2,length:3.4},localPosition:new THREE.Vector3(0,.6,4.15),localQuaternion:new THREE.Quaternion(0,0,0,1),color:16777215,textureFileName:[\"/textures/bodyColor.png\",\"/textures/frontLights.png\"],materialIndex:[0,0,0,0,0,0,0,0,1,1,0,0],materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:3.2,width:.5,length:.9},localPosition:new THREE.Vector3(1.25,.4,.5),localQuaternion:new THREE.Quaternion(0,0,0,1),color:16777215,textureFileName:[\"/textures/bodyColor.png\"],materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:3.2,width:.5,length:.9},localPosition:new THREE.Vector3(-1.25,.4,.5),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/bodyColor.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:1,width:.1,length:.9},localPosition:new THREE.Vector3(1.25,1.15,3.4),localQuaternion:new THREE.Quaternion(0,0,0,1),color:16777215,textureFileName:[\"/textures/bodyColor.png\"],materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:1.2,width:.1,length:.9},localPosition:new THREE.Vector3(1.25,.46+.4,2.4),localQuaternion:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/6),textureFileName:[\"/textures/bodyColor.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:1,width:.1,length:.9},localPosition:new THREE.Vector3(-1.25,1.15,3.4),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/bodyColor.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:1.2,width:.1,length:.9},localPosition:new THREE.Vector3(-1.25,.46+.4,2.4),localQuaternion:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/6),textureFileName:[\"/textures/bodyColor.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"cylinder\",dimension:{radiusTop:.5,radiusBottom:.5,height:.3},radialSegments:32,cylinderHeightSegments:1,localPosition:new THREE.Vector3(0,.4,-2),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/fifthWheel.png\",\"/textures/fifthWheelSide.png\",\"/textures/fifthWheel.png\"],materialIndex:[0,1,2],color:16777215,materialName:\"lambert\"}),e}function Tt(){let e=[];return e.push({geometryName:\"box\",dimension:{height:.5,width:1,length:2},localPosition:new THREE.Vector3(0,.2,1),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/bed.png\"],color:16777215,materialName:\"lambert\",groupName:\"cabin\",collisionGroups:[\"obstacle\"]}),e.push({geometryName:\"box\",dimension:{height:.5,width:1,length:2},localPosition:new THREE.Vector3(0,.2,-2),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/bed.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"cylinder\",dimension:{radiusTop:1.1,radiusBottom:1.1,height:9},localPosition:new THREE.Vector3(0,1.7,3),radialSegments:32,cylinderHeightSegments:1,localQuaternion:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0).normalize(),-Math.PI/2),textureFileName:[\"/textures/tanker.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"sphere\",dimension:{radius:1.1},localPosition:new THREE.Vector3(0,1.7,-1.5),widthSegments:32,heightSegments:32,localQuaternion:new THREE.Quaternion,textureFileName:[\"/textures/tanker.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"sphere\",dimension:{radius:1.1},localPosition:new THREE.Vector3(0,1.7,7.5),widthSegments:32,heightSegments:32,localQuaternion:new THREE.Quaternion,textureFileName:[\"/textures/tanker.png\"],color:16777215,materialName:\"lambert\"}),e}function Ct(){let e=[];return e.push({geometryName:\"cylinder\",dimension:{radiusTop:1.1,radiusBottom:1.1,height:9},localPosition:new THREE.Vector3(0,1.5,3),radialSegments:32,cylinderHeightSegments:1,localQuaternion:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0).normalize(),-Math.PI/2),textureFileName:[\"/textures/tanker.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"sphere\",dimension:{radius:1.1},localPosition:new THREE.Vector3(0,1.5,-1.5),widthSegments:32,heightSegments:32,localQuaternion:new THREE.Quaternion,textureFileName:[\"/textures/tanker.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"sphere\",dimension:{radius:1.1},localPosition:new THREE.Vector3(0,1.5,7.5),widthSegments:32,heightSegments:32,localQuaternion:new THREE.Quaternion,textureFileName:[\"/textures/tanker.png\"],color:16777215,materialName:\"lambert\"}),e.push({geometryName:\"box\",dimension:{height:5.3,width:.2,length:.2},localPosition:new THREE.Vector3(0,0,10.5),localQuaternion:new THREE.Quaternion(0,0,0,1),textureFileName:[\"/textures/bed.png\"],color:16777215,materialName:\"lambert\"}),e}function vt({addTrailer:e}){return vt||mainComposite.loadedObjects.push(e),!0}function jt({visibleTrailers:e,chassisBody:t}){let n=mainComposite.roadTrains;if(e>0&&e<n.length-1&&1==n[e-1].enable&&!n[e].enable){let t=n[e].towingGap,i=n[e].towingRatio,a=e-1,o=n[a].position,s=new THREE.Quaternion(n[a].quaternion.x,n[a].quaternion.y,n[a].quaternion.z,n[a].quaternion.w),r=new THREE.Vector3(0,axelsVerticalFreedom,-t);r.applyQuaternion(s);let l=new THREE.Vector3(o.x+r.x,o.y+r.y,o.z+r.z);n[e].set({newPos:l,newQuat:s,setNewPos:!0}),n[e].frontTowing.set({thisTowingPosition:{x:0,y:0,z:t*(1-i)},otherTowingPosition:{x:0,y:0,z:-t*i},towedRoadTrain:n[a]})}return!0}function Rt({newAnimationFrame:e,startUp:t}){let n=timeStamp-t,i=cameras.camera3.camera,a=roadTrains[0].position,o=roadTrains[0].quaternion,s=roadTrains[0].visibleTrailers+1,r=i.position,l=n;l>2500&&(l=2500),l=2500*Math.pow(1-l/2500,2);let c=new THREE.Vector3(0,l,-(10+l));c.applyQuaternion(o),r.x=c.x+a.x,r.y=c.y+a.y+2+2*s,r.z=c.z+a.z,i.lookAt(new THREE.Vector3(a.x,a.y,a.z)),n>2500&&(t=void 0,self.activateControls())}function Ft(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=a.clone();r.multiply(n),e.objects=[{}],e.constraints=[],e.parts=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"box\",dimension:{height:3,width:3,length:3},position:new THREE.Vector3(0,1.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,textureFileName:[\"/textures/box.jpg\"],color:16777215,materialName:\"lambert\"}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:1,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Pt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=a.clone();r.multiply(n),e.objects=[{}],e.constraints=[],e.parts=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"cylinder\",dimension:{radiusTop:.8,radiusBottom:.8,height:2.2},position:new THREE.Vector3(0,2,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:16777215,materialName:\"lambert\",textureFileName:[\"/textures/barrelTop.jpg\",\"/textures/barrelSide.jpg\",\"/textures/barrelBottom.jpg\"],materialIndex:[0,1,2]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:10,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function St(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],e.parts=[{},{},{},{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"box\",dimension:{height:.1,width:.8,length:8},position:new THREE.Vector3(0,2,0).add(i).applyQuaternion(n).add(t),quaternion:r,textureFileName:[\"/textures/barrierSide.png\"],color:16777215,materialName:\"basic\"}),s.utils.addObject(e.parts[0]),e.parts[0].set({geometryName:\"box\",textureFileName:[\"/textures/barrierStand.png\"],dimension:{height:.1,width:1.4,length:.8},position:new THREE.Vector3(-3,.9,0).add(i).applyQuaternion(n).add(t),quaternion:r,materialName:\"phong\"}),s.utils.addObject(e.parts[1]),e.parts[1].set({geometryName:\"box\",textureFileName:[\"/textures/barrierStand.png\"],dimension:{height:.1,width:1.4,length:.8},position:new THREE.Vector3(3,.9,0).add(i).applyQuaternion(n).add(t),quaternion:r,materialName:\"phong\"}),s.utils.addObject(e.parts[2]),e.parts[2].set({geometryName:\"box\",textureFileName:[\"/textures/barrierStand.png\"],dimension:{height:.8,width:.2,length:.8},position:new THREE.Vector3(-3,.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,materialName:\"phong\"}),s.utils.addObject(e.parts[3]),e.parts[3].set({geometryName:\"box\",textureFileName:[\"/textures/barrierStand.png\"],dimension:{height:.8,width:.2,length:.8},position:new THREE.Vector3(3,.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,materialName:\"phong\"}),s.utils.makePhysicCompound([e.objects[0],...e.parts]),e.objects[0].set({mass:2,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Ht(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],e.parts=[{},{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"box\",dimension:{height:1,width:.1,length:1},position:new THREE.Vector3(0,.05,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:16777215,textureFileName:[\"/textures/coneBaseSide.png\",\"/textures/coneBaseTop.png\",\"/textures/coneBaseBottom.png\"],materialIndex:[0,0,0,0,1,1,2,2,2,2,0,0],materialName:\"basic\"}),s.utils.addObject(e.parts[0]),e.parts[0].set({geometryName:\"cylinder\",dimension:{radiusTop:.04,radiusBottom:.45,height:1.5},position:new THREE.Vector3(0,.8,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/coneTop.png\",\"/textures/coneSide.png\"],materialIndex:[0,1,0]}),s.utils.makePhysicCompound([e.objects[0],...e.parts]),e.objects[0].set({mass:.5,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function zt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:2},position:new THREE.Vector3(0,2.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/jupiter.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:300,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Mt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1.5},position:new THREE.Vector3(0,1.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/earth.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:220,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Ot(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:8},position:new THREE.Vector3(0,4.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/venus.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:500,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Vt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:2.5},position:new THREE.Vector3(0,2.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/mars.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:200,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function kt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:3.5},position:new THREE.Vector3(0,3.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/mercury.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:600,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function At(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1},position:new THREE.Vector3(0,1.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/pluto.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:2e3,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Bt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{}],e.constraints=[],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1.8},position:new THREE.Vector3(0,1.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/sun.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:500,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"})}function Qt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{}],e.constraints=[{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1.5},position:new THREE.Vector3(0,1.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/earth.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.1},position:new THREE.Vector3(0,1.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[1],bodyB:e.objects[0],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:-1,active:!1})}function Lt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{}],e.constraints=[{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:3},position:new THREE.Vector3(0,3.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/mars.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.1},position:new THREE.Vector3(0,3.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[1],bodyB:e.objects[0],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:1,active:!1})}function Dt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{}],e.constraints=[{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:2},position:new THREE.Vector3(0,2.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/venus.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.1},position:new THREE.Vector3(0,2.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[1],bodyB:e.objects[0],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:-2,active:!1})}function qt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{}],e.constraints=[{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1.2},position:new THREE.Vector3(0,1.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/jupiter.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.1},position:new THREE.Vector3(0,1.1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[1],bodyB:e.objects[0],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:-3,active:!1})}function It(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{}],e.constraints=[{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:2.5},position:new THREE.Vector3(0,2.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/mercury.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.1},position:new THREE.Vector3(0,2.6,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[1],bodyB:e.objects[0],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:2,active:!1})}function Wt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{}],e.constraints=[{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1.3},position:new THREE.Vector3(0,1.4,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/haumea.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.1},position:new THREE.Vector3(0,1.4,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[1],bodyB:e.objects[0],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:4,active:!1})}function Gt(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{},{}],e.constraints=[{},{}],s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:1.5},position:new THREE.Vector3(2,1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/sun.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:.7},position:new THREE.Vector3(-4,1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/ceres.jpg\"]}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[2]),e.objects[2].set({geometryName:\"sphere\",dimension:{radius:.4},position:new THREE.Vector3(2,1,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[2]),e.objects[2].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[2],bodyB:e.objects[1],offsetA:{x:0,y:0,z:0},offsetB:{x:6,y:0,z:0},motor:!0,speed:-2,active:!1}),s.utils.newHingeConstraint(e.constraints[1]),e.constraints[1].axisA=new CANNON.Vec3(0,1,0),e.constraints[1].axisB=new CANNON.Vec3(0,1,0),e.constraints[1].set({bodyA:e.objects[0],bodyB:e.objects[2],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:2,active:!1})}function Ut(e,t,n,i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion(0,0,0,1),o){let s=e.getParentComposite,r=new THREE.Quaternion(a.x,a.y,a.z,a.w);r.multiply(n),e.objects=[{},{},{}],e.constraints=[{},{}];s.utils.addObject(e.objects[0]),e.objects[0].set({geometryName:\"sphere\",dimension:{radius:12},position:new THREE.Vector3(0,12,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/jupiter.jpg\"]}),s.utils.addPhysicBody(e.objects[0]),e.objects[0].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[1]),e.objects[1].set({geometryName:\"sphere\",dimension:{radius:1.5},position:new THREE.Vector3(27,12,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\",textureFileName:[\"/textures/haumea.jpg\"]}),s.utils.addPhysicBody(e.objects[1]),e.objects[1].set({mass:100,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.addObject(e.objects[2]),e.objects[2].set({geometryName:\"sphere\",dimension:{radius:11},position:new THREE.Vector3(0,12,0).add(i).applyQuaternion(n).add(t),quaternion:r,color:184549375,materialName:\"basic\"}),s.utils.addPhysicBody(e.objects[2]),e.objects[2].set({mass:0,allowSleep:!0,sleep:!0,physicStatus:!1,visible:o,groupName:\"obstacle\",collisionGroups:[\"wheel\",\"ground\",\"chassis\",\"obstacle\"],physicMaterial:\"objectMaterial\"}),s.utils.newHingeConstraint(e.constraints[0]),e.constraints[0].axisA=new CANNON.Vec3(0,1,0),e.constraints[0].axisB=new CANNON.Vec3(0,1,0),e.constraints[0].set({bodyA:e.objects[2],bodyB:e.objects[1],offsetA:{x:0,y:0,z:0},offsetB:{x:-27,y:0,z:0},motor:!0,speed:-2,active:!1}),s.utils.newHingeConstraint(e.constraints[1]),e.constraints[1].axisA=new CANNON.Vec3(0,1,0),e.constraints[1].axisB=new CANNON.Vec3(0,1,0),e.constraints[1].set({bodyA:e.objects[0],bodyB:e.objects[2],offsetA:{x:0,y:0,z:0},offsetB:{x:0,y:0,z:0},motor:!0,speed:2,active:!1})}function Zt({currentStandingBlock:e}){if(e==Zt)return e;let t=road[e];return t.plot&&null==t.plotRuned&&(t.plotRuned=!0,t.plot(self)),e}function _t({currentStandingBlock:e}){if(e==_t)return e;standingTime=0;let t=road[e];t.checkPoint&&(checkPoint.speed=t.checkPoint.speed,checkPoint.camera=t.checkPoint.camera,checkPoint.block=e);let n=e+t.frontVisibleBlocks,i=e+t.rearVisibleBlocks;n>road.length-1&&(n=road.length-1),i<0&&(i=0);let a=e+t.frontActiveBlocks,o=e+t.rearActiveBlocks;a>road.length-1&&(a=road.length-1),o<0&&(o=0);for(let t=i;t<=n;++t)t>=o&&t<=a?null==road[t].active&&(road[t].active=!0,s(t,!0,!0,!1)):t==i||t==n&&t!=e?s(t,!1,!1,!0):s(t,!1,!0,!1);if(0!=road[e].enablingObstacles.length&&road[e].checkPoint)throw console.error(\"checkpoint block cannot be where obstacle enablig will happen\");if(road[e].enablingObstacles)for(let t of road[e].enablingObstacles)r(t,!0,!0,!1);if(road[e].disablingObstacles)for(let t of road[e].disablingObstacles)r(t,!1,!0,!1);return e;function s(e,t,n,i){if(self.road[e].block.set({physicStatus:t,visible:n,sleep:i,enableCollisionCallback:t}),road[e].blockObstacles){let t=road[e].blockObstacles;for(let e of t)for(obj of e.objects)obj.self.set({visible:n})}}function r(e,t,n,i){for(obj of e.objects)obj.self.set({sleep:i,physicStatus:t,visible:n});for(let n of e.constraints)n.self.set({active:t})}}function Xt({newAnimationFrame:e}){let t=4;if(0==roadTrains[0].speed&&(t=10),standingTime+=actualInterval,standingTime>t||cheating){cheating=!1;for(let e=0,t=road.length;e<t;++e){road[e].active=void 0,road[e].plotRuned=void 0,self.road[e].block.set({physicStatus:!1,visible:!1,sleep:!0,enableCollisionCallback:!1});for(let t=0;t<road[e].blockObstacles.length;++t){for(let n of road[e].blockObstacles[t].constraints)n.self.set({active:!1});for(let n=0;n<road[e].blockObstacles[t].objects.length;++n){let i=road[e].blockObstacles[t].objects[n];i.self.set({position:i.iniPos.clone(),quaternion:i.iniQuat.clone(),reset:!0,physicStatus:!1,visible:!1})}}}return!0}}function $t({performReset:e,newAnimationFrame:t}){if(0==removeBodies.length){let e=new THREE.Vector3(0,2,-7),t=road[checkPoint.block].position.clone(),n=road[checkPoint.block].quaternion,i=new THREE.Vector3(0,1,0).normalize().applyQuaternion(n).normalize();n=(new THREE.Quaternion).setFromAxisAngle(i,Math.PI).multiply(n),e.applyQuaternion(n),t.add(e),roadTrains[0].self.set({resetPos:t.clone(),resetQuat:n,speed:0,steering:0}),checkPoint.camera.active=!0;for(let e=1;e<=roadTrains[0].visibleTrailers;++e){let i=roadTrains[e].towingGap,a=new THREE.Vector3(0,roadTrains[0].axelsVerticalFreedom,-i);a.applyQuaternion(n),t=t.add(a),roadTrains[e].self.set({resetPos:t.clone(),resetQuat:n})}_t=void 0,self.currentStandingBlock=checkPoint.block,void 0}}const Kt=function(){let e=a();return e.composerConfig({upPropagation:!1}),e.loadedObjects=[],e.three=function(e){let t={};return t.scene=new THREE.Scene,t.renderer=new THREE.WebGLRenderer,t.renderer.shadowMap.enabled=!0,t.renderer.shadowMap.type=THREE.PCFSoftShadowMap,t.renderer.setPixelRatio(window.devicePixelRatio>2?2:window.devicePixelRatio),t.renderer.setSize(window.innerWidth,window.innerHeight),e.loadedObjects.push(t),t}(e),e.activeCamera=void 0,e.collisionGroupsNames=[\"all\"],e.utils={},e.utils.addCamera=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.addFunction(o),t.three=e.three.getProxyLessObject,t.mainComposite=e,t.position={x:0,y:0,z:0},t.quaternion={x:0,y:0,z:0,w:0},t.addFunction(s),t.addFunction(d),t.addFunction(r),t.addFunction(l),t.addFunction(u),t.addFunction(c)}(e,t)},e.utils.addLight=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.addFunction(_),t.mainComposite=e,t.color=16777215,t.intensity=.5,t.visible=!0,t.position=new THREE.Vector3(0,0,0),t.targetPosition=new THREE.Vector3(0,0,0),t.castShadow=!1,t.shadowMapDarkness=1,t.shadowMapSizeWidth=4096,t.shadowMapSizeHeight=4096,t.shadowCameraNear=.5,t.shadowCameraFar=4096,t.skyColor=16777147,t.groundColor=526368,t.distance=0,t.width=350,t.height=200,t.addFunction(J),t.addFunction(ee),t.addFunction(X),t.addFunction($),t.addFunction(Y),t.addFunction(K),e.addLink(e.three,t.three)}(e,t)},e.utils.addObject=function(t){p(e,t)},e.utils.addSkyBox=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.addFunction(I),t.mainComposite=e,t.scale=1,t.visible=!1,t.WorldPosition={x:0,y:0,z:0},t.filesExtension=\".png\",t.thickness=1,t.geometryName=void 0,t.physicBody=!0,t.components=[],t.selfProxy=t;for(let n=0,i=t.worldFileNames.length;n<i;++n)t.components[n]={},p(e,t.components[n]),P(e,t.components[n]),e.addLink(t.components[n].texture,t[\"texture\"+String(n)]),t.components[n].set({bodyType:\"static\",mass:0,physicMaterial:\"groundMaterial\",geometryName:\"box\",receiveShadow:5==n,sleep:!0,textureFileName:t.textureFilePath+t.worldFileNames[n]+t.filesExtension});t.addFunction(G),t.addFunction(W);for(let n of[\"scale\",\"visible\"])e.addLink(t[n],t.components[0][n],t.components[1][n],t.components[2][n],t.components[3][n],t.components[4][n],t.components[5][n])}(e,t)},e.utils.addPhysicBody=function(t){P(e,t)},e.utils.makePhysicCompound=function(t){!function(e,t){t[0].cannon=e.cannon.getProxyLessObject,t[0].materials=e.physicSettings.materials.getProxyLessObject,t[0].collisionGroupsNames=e.collisionGroupsNames.getProxyLessObject,t[0].mainComposite=e,t[0].self=t[0],t[0].totalConstraints=0,t[0].physicMaterial||(t[0].physicMaterial=\"objectMaterial\"),t[0].linearDamping||(t[0].linearDamping=.15),t[0].angularDamping||(t[0].angularDamping=.15),t[0].cylinderSegments||(t[0].cylinderSegments=16),null==t[0].widthSegments&&(t[0].widthSegments=32),null==t[0].heightSegments&&(t[0].heightSegments=32),null==t[0].radialSegments&&(t[0].radialSegments=32),null==t[0].cylinderHeightSegments&&(t[0].cylinderHeightSegments=1),t[0].allowSleep||(t[0].allowSleep=!1),void 0===t[0].physicStatus&&(t[0].physicStatus=!0),null==t[0].sleep&&(t[0].sleep=!1),null==t[0].timeStamp&&(t[0].timeStamp=0),null==t[0].bodyType&&(t[0].bodyType=\"dynamic\"),null==t[0].groupName&&(t[0].groupName=\"all\"),null==t[0].collisionGroups&&(t[0].collisionGroups=[\"all\"]),t[0].addFunction(Q),t[0].addFunction(k),t[0].addFunction(B),t[0].addFunction(q),t[0].addFunction(D),t[0].addFunction(se),t[0].addFunction(O),t[0].addFunction(z),t[0].addFunction(M),t[0].addFunction(H),t[0].addFunction(L),t[0].addFunction(S),t[0].components=[];for(let n=1,i=t.length;n<i;++n)t[0].components.push(t[n].getProxyLessObject),t[n].cylinderSegments||(t[n].cylinderSegments=16),t[n].addFunction(q),t[n].addFunction(ae),t[n].addFunction(oe),t[n].mainComposite=e,e.addLink(t[0].body,t[n].body),e.addLink(t[0].visible,t[n].visible),t[n].cylinderSegments||(t[n].cylinderSegments=16),null==t[n].widthSegments&&(t[n].widthSegments=32),null==t[n].heightSegments&&(t[n].heightSegments=32),null==t[n].radialSegments&&(t[n].radialSegments=32),null==t[n].cylinderHeightSegments&&(t[n].cylinderHeightSegments=1),t[n].compoundBodyShapeNumber=void 0}(e,t)},e.utils.newLockConstraint=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.mainComposite=e,e.addLink(e.cannon,t.cannon),t.selfProxy=t,t.self=t,t.constraints=[],t.linkedBodies=[],t.addedIndex=0,t.active=!0,t.maxForce=1e6,t.addFunction(re),t.addFunction(le),t.addFunction(ce)}(e,t)},e.utils.newPointsConstraint=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.addFunction(de),t.mainComposite=e,e.addLink(e.cannon,t.cannon),t.selfProxy=t,t.self=t,t.active=!0,t.maxForce=1e6,t.offsetA={x:0,y:0,z:0},t.offsetB={x:0,y:0,z:0},t.addFunction(ue),t.addFunction(pe),t.addFunction(ge),t.addFunction(be),t.addFunction(me),t.addFunction(he)}(e,t)},e.utils.newDistanceConstraint=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.mainComposite=e,t.addFunction(ye),e.addLink(e.cannon,t.cannon),t.selfProxy=t,t.self=t,t.active=!0,t.maxForce=1e6,t.distance=void 0,t.addFunction(we),t.addFunction(fe),t.addFunction(xe),t.addFunction(Ne)}(e,t)},e.utils.newHingeConstraint=function(t){!function(e,t){t.loadedObjects=e.loadedObjects.getProxyLessObject,t.addFunction(Ee),t.mainComposite=e,e.addLink(e.cannon,t.cannon),t.selfProxy=t,t.self=t,t.active=!0,t.maxForce=1e6,t.offsetA={x:0,y:0,z:0},t.offsetB={x:0,y:0,z:0},t.addFunction(Te),t.addFunction(Ce),t.addFunction(Re),t.addFunction(Fe),t.addFunction(ve),t.addFunction(je),t.addFunction(Pe),t.addFunction(Se)}(e,t)},e.utils.newRigidVehicle=function(t){!function(e,t){e.vehicles[t]={};let n=e.vehicles[t];e.addLink(e.cannon,n.cannon),n.linkedWheelsBodies=[],n.angularDamping=.4,n.position=void 0,n.quaternion=void 0,n.wheelForce=void 0,n.wheelSpeed=void 0,n.addFunction(He),n.addFunction(Me),n.addFunction(ke),n.addFunction(Ae),n.addFunction(Be),n.addFunction(Oe),n.addFunction(Ve),n.addFunction(ze)}(e,t)},e.utils.newRayCastVehicle=function(t){!function(e,t){e.vehicles[t]={};let n=e.vehicles[t];e.addLink(e.cannon,n.cannon),e.addLink(e.timeStamp,n.timeStamp),n.linkedWheelsBodies=[],n.angularDamping=.4,n.position=void 0,n.quaternion=void 0,n.wheelOptions={radius:9,directionLocal:new CANNON.Vec3(0,-1,0),suspensionStiffness:43,suspensionRestLength:.18,frictionSlip:1e4,dampingRelaxation:1,dampingCompression:1,maxSuspensionForce:1e4,rollInfluence:0,axleLocal:new CANNON.Vec3(-1,0,0),chassisConnectionPointLocal:new CANNON.Vec3(1,0,1),maxSuspensionTravel:10,customSlidingRotationalSpeed:30,useCustomSlidingRotationalSpeed:!0},n.addFunction(Le),n.addFunction(qe),n.addFunction(Ge),n.addFunction(Ue),n.addFunction(Ze),n.addFunction(Ie),n.addFunction(We),n.addFunction(De),n.addFunction(Qe)}(e,t)},e.utils.newRoadTrain=function(t){nt(e,t)},e.utils.start=U,e.self=e,e.cameras={},e.worlds={},e.lights={},function(e){e.physicSettings={},e.cannon=ne(),e.loadedObjects.push(e.cannon.getProxyLessObject),e.addLink(e.cannon,e.physicSettings.cannon),e.physicSettings.addFunction(ie),e.physicSettings.gravity={x:0,y:-10,z:0},e.physicSettings.materials={},e.physicSettings.contactMaterials=[],e.physicSettings.addFunction(te),e.physicSettings.materials.groundMaterial=new CANNON.Material({name:\"groundMaterial\"}),e.physicSettings.materials.objectMaterial=new CANNON.Material({name:\"objectMaterial\"}),e.physicSettings.materials.wheelMaterial=new CANNON.Material({name:\"wheelMaterial\"}),e.physicSettings.materials.fakeWheelMaterial=new CANNON.Material({name:\"fakeWheelMaterial\"}),e.physicSettings.materials.chassisMaterial=new CANNON.Material({name:\"chassisMaterial\"}),e.physicSettings.materials.frontWheelMaterial=new CANNON.Material({name:\"frontWheelMaterial\"}),e.physicSettings.contactMaterials[0]={material1:\"groundMaterial\",material2:\"objectMaterial\",friction:.4,restitution:.4},e.physicSettings.contactMaterials[1]={material1:\"groundMaterial\",material2:\"wheelMaterial\",friction:1.4,restitution:0},e.physicSettings.contactMaterials[2]={material1:\"objectMaterial\",material2:\"wheelMaterial\",friction:1,restitution:.2},e.physicSettings.contactMaterials[3]={material1:\"objectMaterial\",material2:\"fakeWheelMaterial\",friction:.1,restitution:0},e.physicSettings.contactMaterials[4]={material1:\"groundMaterial\",material2:\"fakeWheelMaterial\",friction:.1,restitution:0},e.physicSettings.contactMaterials[5]={material1:\"objectMaterial\",material2:\"chassisMaterial\",friction:.3,restitution:.2},e.physicSettings.contactMaterials[6]={material1:\"groundMaterial\",material2:\"frontWheelMaterial\",friction:1.7,restitution:0}}(e),e.actualInterval=0,e.running=!1,e.settings=Z,e.addFunction(dt),e.loadedObjects.push(e),e.removeBodies=[],e}();var Yt;Kt.cheating=!1,console.log(Kt),(Yt=Kt).cameras.camera3={},Yt.utils.addCamera(Yt.cameras.camera3),Yt.cameras.camera3.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!0}),Yt.cameras.camera10={},Yt.utils.addCamera(Yt.cameras.camera10),Yt.cameras.camera10.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),Yt.cameras.camera7={},Yt.utils.addCamera(Yt.cameras.camera7),Yt.cameras.camera7.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),Yt.cameras.camera8={},Yt.utils.addCamera(Yt.cameras.camera8),Yt.cameras.camera8.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),Yt.cameras.camera9={},Yt.utils.addCamera(Yt.cameras.camera9),Yt.cameras.camera9.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),Yt.cameras.cameraT={},Yt.utils.addCamera(Yt.cameras.cameraT),Yt.cameras.cameraT.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),Yt.cameras.camera11={},Yt.utils.addCamera(Yt.cameras.camera11),Yt.cameras.camera11.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),Yt.cameras.camera12={},Yt.utils.addCamera(Yt.cameras.camera12),Yt.cameras.camera12.set({cameraFocalLenght:75,cameraNearView:.01,cameraFarView:800,active:!1}),function(e){e.lights.ambient1={},e.utils.addLight(e.lights.ambient1),e.lights.ambient1.set({lightType:\"ambient\",intensity:.5}),e.lights.directional={},e.utils.addLight(e.lights.directional),e.lights.directional.set({lightType:\"directional\",intensity:.7,position:{x:0,y:500,z:0},targetPosition:new THREE.Vector3(0,0,0)})}(Kt),function(e){let t=e.getProxyLessObject.three.scene,n=new THREE.Geometry;for(let e=0;e<5e3;e++){let e=new THREE.Vector3;e.x=THREE.Math.randFloatSpread(3e3),e.y=THREE.Math.randFloatSpread(1e3),e.z=THREE.Math.randFloatSpread(3e3),n.vertices.push(e)}let i=new THREE.PointsMaterial({color:8947848}),a=new THREE.Points(n,i);t.add(a),e.loadedObjects.push(a)}(Kt),function(e){let t,n,i,a,o,s,r,l,c,d,u,p,m,h,g,b,y=e.getProxyLessObject,w=function(e){let t=Math.PI/16;return[{width:15,length:30,tickness:.8,position:{x:0,y:0,z:0},quaternion:{x:0,y:0,z:0,w:1},color:16777215,materialName:\"lambert\",physicMaterial:\"groundMaterial\",offset:{x:0,y:.01,z:0},textureFileName:[\"/textures/road1.png\",\"/textures/roadTrain.png\"],materialIndex:[0,0,0,0,0,0,0,0,1,1,0,0],frontActiveBlocks:4,rearActiveBlocks:-4,frontVisibleBlocks:9,rearVisibleBlocks:-5},{plot:e=>{e.roadTrains[0].speed=15},up:t,obstacles:[{build:Ht,localPos:{x:-5,y:.4,z:-15},enablingDistance:0,disablingDistance:2}]},{up:t,obstacles:[{build:Ht,localPos:{x:4,y:.4,z:-10},enablingDistance:0,disablingDistance:2}]},{up:t,obstacles:[{build:Mt,localPos:{x:-1,y:5,z:-7},enablingDistance:-2,disablingDistance:1}]},{down:t},{down:t},{down:t},{plot:e=>{e.roadTrains[0].speed=8},down:t,obstacles:[{build:Ot,localPos:{x:0,y:18,z:-7},enablingDistance:1,disablingDistance:8}]},{plot:e=>{e.cameraTransitionPlot=[{startCam:e.cameras.camera3,endCam:e.cameras.camera10,movingSpeed:500,movingType:2,rotatingSpeed:500,rotatingType:2},{startCam:e.cameras.camera10,endCam:e.cameras.camera7,movingSpeed:500,movingType:3,rotatingSpeed:500,rotatingType:1}]},frontVisibleBlocks:9,rearVisibleBlocks:-8,obstacles:[{build:Ht,localPos:{x:4,y:.4,z:0},enablingDistance:0,disablingDistance:2},{build:Ht,localPos:{x:-4,y:.4,z:-10},enablingDistance:0,disablingDistance:2}]},{obstacles:[{build:Ht,localPos:{x:0,y:.4,z:10},enablingDistance:0,disablingDistance:2},{build:Ht,localPos:{x:4,y:.4,z:0},enablingDistance:0,disablingDistance:2},{build:Ht,localPos:{x:-4,y:.4,z:-10},enablingDistance:0,disablingDistance:2}]},{uo:t,obstacles:[{build:Ht,localPos:{x:2,y:.4,z:10},enablingDistance:0,disablingDistance:2},{build:Ht,localPos:{x:-5,y:.4,z:0},enablingDistance:0,disablingDistance:2},{build:Ht,localPos:{x:5,y:.4,z:-10},enablingDistance:0,disablingDistance:2}]},{left:2*t,obstacles:[{build:St,localPos:{x:4,y:.5,z:10},enablingDistance:0,disablingDistance:2}],plot:e=>{e.cameraTransitionPlot=[{startCam:e.cameras.camera7,endCam:e.cameras.camera3,movingSpeed:1500,movingType:2,rotatingSpeed:1500,rotatingType:1}]}},{obstacles:[{build:Ft,localPos:{x:-5,y:.4,z:0},enablingDistance:-1,disablingDistance:3},{build:Ft,localPos:{x:0,y:.4,z:0},enablingDistance:-1,disablingDistance:3},{build:Ft,localPos:{x:5,y:.4,z:0},enablingDistance:-1,disablingDistance:3},{build:Ft,localPos:{x:-3,y:3.4,z:0},enablingDistance:-1,disablingDistance:3},{build:Ft,localPos:{x:0,y:6.4,z:0},enablingDistance:-1,disablingDistance:3},{build:Ft,localPos:{x:3,y:3.4,z:0},enablingDistance:-1,disablingDistance:3}]},{},{checkPoint:{speed:18,camera:e.cameras.camera3},left:2*t},{plot:e=>{e.roadTrains[0].speed=14},left:2*t},{left:2*t,obstacles:[{build:St,localPos:{x:4,y:.6,z:10},enablingDistance:0,disablingDistance:1}]},{left:t,obstacles:[{build:Qt,localPos:{x:-3,y:2,z:10},enablingDistance:-2,disablingDistance:1},{build:Dt,localPos:{x:3,y:2,z:0},enablingDistance:-2,disablingDistance:1},{build:Lt,localPos:{x:-3,y:2,z:-10},enablingDistance:-2,disablingDistance:1}]},{textureNumber:0,obstacles:[{build:Ht,localPos:{x:-3,y:.4,z:0},enablingDistance:-1,disablingDistance:1},{build:qt,localPos:{x:-3,y:2,z:10},enablingDistance:-1,disablingDistance:1},{build:It,localPos:{x:3,y:2,z:0},enablingDistance:-1,disablingDistance:1},{build:Wt,localPos:{x:-3,y:2,z:-10},enablingDistance:-1,disablingDistance:1}]},{right:2*t,obstacles:[{build:Pt,localPos:{x:-2,y:2,z:0},enablingDistance:0,disablingDistance:2},{build:Pt,localPos:{x:-2,y:.4,z:0},enablingDistance:0,disablingDistance:2},{build:Pt,localPos:{x:0,y:.4,z:0},enablingDistance:0,disablingDistance:2},{build:Pt,localPos:{x:2,y:.4,z:0},enablingDistance:0,disablingDistance:2},{build:Pt,localPos:{x:4,y:.4,z:0},enablingDistance:0,disablingDistance:2}]},{right:2*t,plot:e=>{e.roadTrains[0].speed=20}},{right:2*t,checkPoint:{speed:20,camera:e.cameras.camera11},frontActiveBlocks:6},{right:2*t,plot:e=>{e.framesInterval<25&&(e.roadTrains[0].visibleTrailers<2&&++e.roadTrains[0].visibleTrailers,e.activeCamera==e.cameras.camera3&&(e.cameraTransitionPlot=[{startCam:e.cameras.camera3,endCam:e.cameras.camera11,movingSpeed:3e3,movingType:1,rotatingSpeed:1500,rotatingType:3}]))}},{right:2*t},{up:1*t},{up:1*t,obstacles:[{build:Pt,localPos:{x:-2,y:.4,z:-4},enablingDistance:0,disablingDistance:2},{build:Pt,localPos:{x:4,y:.4,z:4},enablingDistance:0,disablingDistance:2}]},{obstacles:[{build:Pt,localPos:{x:-2,y:.4,z:-3},enablingDistance:0,disablingDistance:2}],up:2*t},{obstacles:[{build:Ht,localPos:{x:4,y:.4,z:0},enablingDistance:0,disablingDistance:-1}]},{obstacles:[{build:Mt,localPos:{x:4,y:50,z:0},enablingDistance:-4,disablingDistance:-1}]},{obstacles:[{build:kt,localPos:{x:8,y:50,z:0},enablingDistance:-4,disablingDistance:-1}]},{obstacles:[{build:Vt,localPos:{x:2,y:50,z:0},enablingDistance:-4,disablingDistance:-1}]},{obstacles:[{build:Bt,localPos:{x:4,y:50,z:0},enablingDistance:-4,disablingDistance:-1}]},{obstacles:[{build:St,localPos:{x:4,y:.4,z:10},enablingDistance:0,disablingDistance:1}],plot:e=>{e.roadTrains[0].speed=20}},{checkPoint:{speed:20,camera:e.cameras.camera11}},{obstacles:[{build:St,localPos:{x:-4,y:.4,z:10},enablingDistance:0,disablingDistance:1}]},{obstacles:[{build:Pt,localPos:{x:-3,y:.4,z:-7},enablingDistance:-1,disablingDistance:2},{build:Pt,localPos:{x:3,y:.4,z:7},enablingDistance:-1,disablingDistance:2}]},{obstacles:[{build:Ut,localPos:{x:24,y:-8,z:0},enablingDistance:-2,disablingDistance:2},{build:Pt,localPos:{x:-3,y:.4,z:0},enablingDistance:-2,disablingDistance:1},{build:Pt,localPos:{x:-3,y:.4,z:-5},enablingDistance:-2,disablingDistance:1},{build:Pt,localPos:{x:-3,y:.4,z:-8},enablingDistance:-2,disablingDistance:1}]},{obstacles:[{build:At,localPos:{x:4,y:15,z:0},enablingDistance:0,disablingDistance:3}]},{obstacles:[{build:Gt,localPos:{x:-5,y:1,z:0},enablingDistance:-2,disablingDistance:2},{build:Pt,localPos:{x:4,y:.4,z:-10},enablingDistance:-2,disablingDistance:1},{build:Pt,localPos:{x:-4,y:.4,z:10},enablingDistance:-2,disablingDistance:1}]},{down:t,plot:e=>{e.roadTrains[0].speed=25}},{checkPoint:{speed:25,camera:e.cameras.camera11}},{down:t,plot:e=>{e.framesInterval<25&&(e.roadTrains[0].visibleTrailers<2&&++e.roadTrains[0].visibleTrailers,e.activeCamera==e.cameras.camera11&&(e.cameraTransitionPlot=[{startCam:e.cameras.camera11,endCam:e.cameras.camera12,movingSpeed:3e3,movingType:1,rotatingSpeed:1500,rotatingType:3}]))}},{down:t,obstacles:[{build:kt,localPos:{x:-2,y:15,z:0},enablingDistance:0,disablingDistance:3}]},{},{obstacles:[{build:zt,localPos:{x:0,y:15,z:0},enablingDistance:0,disablingDistance:3}]},{up:t,obstacles:[{build:St,localPos:{x:4,y:.4,z:10},enablingDistance:0,disablingDistance:3}]},{},{left:3*t,offset:{x:0,y:-.05,z:0}},{right:2*t},{right:2*t},{right:2*t},{right:2*t},{right:2*t,obstacles:[{build:St,localPos:{x:4,y:.4,z:10},enablingDistance:0,disablingDistance:3},{build:St,localPos:{x:4,y:.4,z:-10},enablingDistance:0,disablingDistance:3}]},{},{},{}]}(e);e.road=w,e.checkPoint={block:0,speed:10,camera:e.cameras.camera3};let f=new THREE.Vector3(1,0,0),x=new THREE.Vector3(0,1,0),N=w[0].frontVisibleBlocks;for(let t=0,n=w.length;t<n;++t)e.road[t].block={},e.road[t].enablingObstacles=[],e.road[t].disablingObstacles=[];for(let E=0,T=w.length;E<T;++E){let T=w[E];if(T.active=void 0,void 0!==T.width&&(t=T.width),void 0!==T.length&&(n=T.length),void 0!==T.tickness&&(i=T.tickness),void 0!==T.color&&(s=T.color),void 0!==T.materialName&&(r=T.materialName),void 0!==T.physicMaterial&&(l=T.physicMaterial),void 0!==T.offset&&(c=T.offset),void 0!==T.frontVisibleBlocks?g=T.frontVisibleBlocks:T.frontVisibleBlocks=g,void 0!==T.rearVisibleBlocks?b=T.rearVisibleBlocks:T.rearVisibleBlocks=b,void 0!==T.frontActiveBlocks?m=T.frontActiveBlocks:T.frontActiveBlocks=m,void 0!==T.rearActiveBlocks?h=T.rearActiveBlocks:T.rearActiveBlocks=h,\"textureFileName\"in T?(d=T.textureFileName,p=T.materialIndex,u=void 0):d=void 0,\"textureNumber\"in T?u=T.textureNumber:void 0===u&&void 0===d&&(u=E-1),void 0===T.position){let e,s=w[E-1],r=new THREE.Quaternion(s.quaternion.x,s.quaternion.y,s.quaternion.z,s.quaternion.w);T.up&&(e=(new THREE.Quaternion).setFromAxisAngle(f,T.up)),T.down&&(e=(new THREE.Quaternion).setFromAxisAngle(f,-T.down)),T.left&&(e=(new THREE.Quaternion).setFromAxisAngle(x,T.left)),T.right&&(e=(new THREE.Quaternion).setFromAxisAngle(x,-T.right)),void 0!==e&&r.multiply(e),o=new THREE.Quaternion(r.x,r.y,r.z,r.w),a=T.up||T.down||T.right?new THREE.Vector3(c.x+t/2,c.y-i/2,c.z-n/2).applyQuaternion(o).add(s.leftCorner):new THREE.Vector3(c.x-t/2,c.y-i/2,c.z-n/2).applyQuaternion(o).add(s.rightCorner)}void 0!==T.position&&(a=new THREE.Vector3(T.position.x,T.position.y,T.position.z)),void 0!==T.quaternion&&(o=new THREE.Quaternion(T.quaternion.x,T.quaternion.y,T.quaternion.z,T.quaternion.w)),T.rightCorner=new THREE.Vector3(t/2,i/2,-n/2).applyQuaternion(o).add(a),T.leftCorner=new THREE.Vector3(-t/2,i/2,-n/2).applyQuaternion(o).add(a),T.rearRightCorner=new THREE.Vector3(t/2,i/2,n/2).applyQuaternion(o).add(a),T.rearLeftCorner=new THREE.Vector3(-t/2,i/2,n/2).applyQuaternion(o).add(a),T.bigX=Math.max(T.rightCorner.x,T.leftCorner.x,T.rearRightCorner.x,T.rearLeftCorner.x),T.smallX=Math.min(T.rightCorner.x,T.leftCorner.x,T.rearRightCorner.x,T.rearLeftCorner.x),T.bigZ=Math.max(T.rightCorner.z,T.leftCorner.z,T.rearRightCorner.z,T.rearLeftCorner.z),T.smallZ=Math.min(T.rightCorner.z,T.leftCorner.z,T.rearRightCorner.z,T.rearLeftCorner.z),T.position=a,T.quaternion=o,null!=u&&void 0===d&&(e.addLink(e.road[u].block.texture,e.road[E].block.texture),e.addLink(e.road[u].block.materialIndex,e.road[E].block.materialIndex)),e.utils.addObject(e.road[E].block),e.road[E].block.set({geometryName:\"box\",dimension:{height:n,width:i,length:t},position:a,quaternion:o,color:s,materialName:r,physicMaterial:l,textureFileName:d,materialIndex:p,sleep:!0,physicStatus:0==E,visible:!1}),e.utils.addPhysicBody(e.road[E].block),e.road[E].block.set({mass:0,allowSleep:!0,sleep:!0,groupName:\"ground\",collisionGroups:[\"wheel\",\"obstacle\",\"chassis\"],enableCollisionCallback:!0,collisionCallback:function(t){t.body.collisionFilterGroup==y.roadTrains[0].wheelsBodies[0].collisionFilterGroup&&(E>y.currentStandingBlock||null==y.currentStandingBlock)&&(e.currentStandingBlock=E)}}),e.road[E].blockObstacles=[];let C=e.road[E].blockObstacles;if(null!=T.obstacles)for(let t of T.obstacles){C.push({});let n=C[C.length-1];t.build(n,a,o,t.localPos,t.localQuat,E<=N);for(let e of n.objects)e.iniPos=e.position.clone(),e.iniQuat=e.quaternion.clone();e.road[E+t.enablingDistance].enablingObstacles.push(e.road[E].blockObstacles[C.length-1]),e.road[E+t.disablingDistance].disablingObstacles.push(e.road[E].blockObstacles[C.length-1])}}}(Kt),function(e){e.standingTime=0,e.addFunction(_t),e.addFunction(Zt),e.addFunction(Xt),e.addFunction($t)}(Kt),function(e){let t=0,n=1,i=10,a=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0).normalize(),Math.PI);e.roadTrains=[],e.roadTrains.push({}),e.utils.newRoadTrain(e.roadTrains[0]),e.roadTrains[0].set({position:{x:t,y:n,z:i},quaternion:new THREE.Quaternion(a.x,a.y,a.z,a.w),axelsVerticalFreedom:.2,chassisTickness:.05,chassisMass:30,chassisFrontLength:4.1,chassisRearLength:-4.3,chassisColor:16777215,wheelsInfo:ft(),cabinInfo:Et(),cabinPhysic:!0,enable:!0,initialSpeed:7});for(let t=0;t<4;++t){e.roadTrains.push({});let n=e.roadTrains.length-1;e.utils.newRoadTrain(e.roadTrains[n]),e.roadTrains[n].set({position:{x:0,y:0,z:0},quaternion:{x:0,y:0,z:0,w:1},axelsVerticalFreedom:.2,chassisMass:10,chassisTickness:.05,chassisFrontLength:0==t?1.2:8,chassisRearLength:-2,chassisWidth:2,chassisColor:16777215,wheelsInfo:0==t?xt():Nt(),cabinInfo:0==t?Tt():Ct(),towingGap:0==t?10:16,towingRatio:0==t?.4:.18,cabinPhysic:!0})}e.roadTrains[0].addFunction(jt),e.roadTrains[0].addFunction(vt),e.roadTrains[0].visibleTrailers=0,e.loadedObjects.push(e.roadTrains)}(Kt),function(e){e.transitionData=void 0,e.addFunction(pt),e.addFunction(gt),e.addFunction(bt),e.addFunction(yt),e.addFunction(wt),e.addFunction(ut),e.addFunction(mt),e.addFunction(ht)}(Kt),function(e){let t,n=void 0,i=e.roadTrains[0],a=i.touchSpan,o=i.absMaxSteering;function s(e){e.preventDefault();let s=e.changedTouches[0].clientX;t=o*(s-n)/a,t>o&&(t=o),t<-o&&(t=-o),i.steering=t}function r(t){t.preventDefault(),n=t.touches[0].clientX,0==i.speed&&(i.speed=e.checkPoint.speed)}function l(e){e.preventDefault()}function c(t){\"Right\"!=t.key&&\"ArrowRight\"!=t.key||i.turningRight||i.set({turningRight:!0,turningLeft:!1}),\"Left\"!=t.key&&\"ArrowLeft\"!=t.key||i.turningLeft||i.set({turningRight:!1,turningLeft:!0}),\"Up\"!=t.key&&\"ArrowUp\"!=t.key||0==i.speed&&(i.speed=e.checkPoint.speed),\"t\"==t.key&&++i.visibleTrailers,t.preventDefault()}function d(t){\"Right\"!=t.key&&\"ArrowRight\"!=t.key||(i.turningRight=!1),\"Left\"!=t.key&&\"ArrowLeft\"!=t.key||(i.turningLeft=!1),\"c\"==t.key&&(e.set({cheating:!0}),e.checkPoint.block=20,e.checkPoint.speed=20,e.checkPoint.camera=e.cameras.camera3)}e.activateControls=function(){document.addEventListener(\"keydown\",c,!1),document.addEventListener(\"keyup\",d,!1),document.addEventListener(\"touchstart\",r,{passive:!1}),document.addEventListener(\"touchend\",l,{passive:!1}),document.addEventListener(\"touchmove\",s,{passive:!1})}}(Kt),function(e){e.addFunction(Rt)}(Kt),Kt.utils.start(Kt)}]);","extractedComments":[]}